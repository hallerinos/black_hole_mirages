(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    197721,       4889]
NotebookOptionsPosition[    190060,       4761]
NotebookOutlinePosition[    190576,       4780]
CellTagsIndexPosition[    190533,       4777]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 ButtonBox[
  RowBox[{"Black", " ", "Hole", " ", 
   RowBox[{"Mirages", ":", " ", 
    RowBox[{
    "electron", " ", "lensing", " ", "and", " ", "Berry", " ", "curvature", 
     " ", "effects", " ", "in", " ", "inhomogeneously", " ", "tilted", " ", 
     "Weyl", " ", "semimetals"}]}]}],
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/2210.16254"], None},
  ButtonNote->"https://arxiv.org/abs/2210.16254"]], "Subtitle",
 CellChangeTimes->{{3.876372690381579*^9, 3.87637269737879*^9}, {
  3.876372767311132*^9, 3.876372805634338*^9}, {3.876372903415181*^9, 
  3.87637290525632*^9}},ExpressionUUID->"85bcbaea-da79-47a9-8841-\
3e5fd17331cb"],

Cell[TextData[{
 "Andreas ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Haller", "*"], TraditionalForm]],ExpressionUUID->
  "219cf1b3-2d59-466a-abf7-c03e5d96bcf2"],
 ", Suraj Hegde, Chen Xu, Christophe De Beule, Thomas L. Schmidt, Tobias Meng\
\n* ",
 ButtonBox["andreas.haller@uni.lu",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["mailto:andreas.haller@uni.lu"], None},
  ButtonNote->"mailto:andreas.haller@uni.lu"]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.87637281627984*^9, 
  3.876372889055265*^9}},ExpressionUUID->"972199aa-7d14-4887-b813-\
b221dd610ba3"],

Cell[CellGroupData[{

Cell["Auxiliary Functions and Modules", "Subsection",
 CellChangeTimes->{{3.8762116731676607`*^9, 3.87621168019105*^9}, {
  3.8763726780972*^9, 
  3.876372683856434*^9}},ExpressionUUID->"16834aeb-6dc8-44ad-b1a3-\
534a9027c016"],

Cell[CellGroupData[{

Cell["SEOM Solutions", "Subsubsection",
 CellChangeTimes->{{3.876278450395162*^9, 
  3.876278455223147*^9}},ExpressionUUID->"bf937a19-27d2-4354-aaf4-\
706dd50f00fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"some", " ", "auxiliary", " ", "functions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "norm", ",", "hat", ",", "\[Rho]", ",", "\[Rho]s", ",", "v", ",", 
     "\[Alpha]", ",", "r"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"norm", "[", "v_", "]"}], ":=", 
     SqrtBox[
      RowBox[{"v", ".", "v"}]]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"convenient", " ", "norm"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hat", "[", "v_", "]"}], ":=", 
     FractionBox["v", 
      RowBox[{"norm", "[", "v", "]"}]]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"unit", " ", "vector"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]", "[", "v_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"0", 
        RowBox[{"v", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"sph", "."}], "\[TwoWayRule]", 
     RowBox[{
      RowBox[{
       RowBox[{"cyl", "."}], " ", ":", " ", 
       RowBox[{"0", 
        RowBox[{"v", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], " ", "\[TwoWayRule]", " ", 
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]s", "[", 
      RowBox[{"r_", ",", "\[Alpha]_"}], "]"}], ":=", 
     RowBox[{"r", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Alpha]"}], ")"}], 
       FractionBox["1", 
        RowBox[{"2", " ", "\[Alpha]"}]]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{
    "L", ",", "spin", ",", "J", ",", " ", "xv", ",", "kv", ",", "\[Chi]"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "[", 
      RowBox[{"xv_", ",", "kv_"}], "]"}], ":=", 
     RowBox[{"xv", "\[Cross]", "kv"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"angular", " ", "momentum"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"spin", "[", 
      RowBox[{"\[Chi]_", ",", "kv_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["\[Chi]", "2"], 
      RowBox[{"hat", "[", "kv", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"J", "[", 
      RowBox[{"\[Chi]_", ",", "xv_", ",", "kv_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{"xv", ",", "kv"}], "]"}], "+", 
      RowBox[{"spin", "[", 
       RowBox[{"\[Chi]", ",", "kv"}], "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"total", " ", "angular", " ", "momentum"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{
    "u", ",", "r", ",", "vF", ",", "rt", ",", "r", ",", "\[Alpha]", ",", 
     "v"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"\[Alpha]_", ",", "vF_", ",", "rt_", ",", "r_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", "vF"}], 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["rt", "r"], ")"}], "\[Alpha]"]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"scalar", " ", "part", " ", "of", " ", "the", " ", "tilt"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"\[Alpha]_", ",", "vF_", ",", "rt_", ",", "v_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", 
        RowBox[{"norm", "[", 
         RowBox[{"\[Rho]", "[", "v", "]"}], "]"}]}], "]"}], "*", 
      RowBox[{"hat", "[", 
       RowBox[{"\[Rho]", "[", "v", "]"}], "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", "tilt", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalOmega]", "[", 
      RowBox[{"\[Chi]_", ",", "v_"}], "]"}], ":=", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Chi]", " "}], "2"], 
      FractionBox["v", 
       SuperscriptBox[
        RowBox[{"norm", "[", "v", "]"}], "3"]]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"Berry", " ", "curvature"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Epsilon]", "[", 
      RowBox[{"\[Alpha]_", ",", "vF_", ",", "rt_", ",", "xs_", ",", "ks_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"uv", "[", 
        RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", 
         RowBox[{"\[Rho]", "[", "xs", "]"}]}], "]"}], ".", "ks"}], "+", 
      RowBox[{"vF", "*", 
       RowBox[{"norm", "[", "ks", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"energy", " ", "dispersion"}], " ", "*)"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "main", " ", "module", " ", "for", " ", "solving", " ", "the",
      " ", "SEOM"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{
    "solveSEOM", ",", "x0", ",", "k0", ",", "vF", ",", "rt", ",", "\[Alpha]", 
     ",", "\[Chi]", ",", "ti", ",", "tf", ",", "t"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"solveSEOM", "[", 
      RowBox[{
      "s_", ",", "x0_", ",", "k0_", ",", "vF_", ",", "rt_", ",", "\[Alpha]_", 
       ",", "\[Chi]_", ",", 
       RowBox[{"ti_", ":", 
        RowBox[{"-", "20"}]}], ",", 
       RowBox[{"tf_", ":", "20"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "define", " ", "variables", " ", "in", " ", "module", " ", "scope"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "xv", ",", "kv", ",", " ", "r", ",", "x", ",", "y", ",", "z", ",", 
         "kx", ",", "ky", ",", "kz", ",", "eq1", ",", "eq2", ",", "eq3", ",", 
         "eq4", ",", " ", "problem", ",", " ", "solution", ",", "xvs", ",", 
         "kvs", ",", "tstop", ",", "return", ",", "t"}], "}"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"module", " ", "body"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xv", "[", "t_", "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], ",", 
           RowBox[{"y", "[", "t", "]"}], ",", 
           RowBox[{"z", "[", "t", "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kv", "[", "t_", "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kx", "[", "t", "]"}], ",", 
           RowBox[{"ky", "[", "t", "]"}], ",", 
           RowBox[{"kz", "[", "t", "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eq1", "[", "t_", "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"xv", "'"}], "[", "t", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"+", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", 
                RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", 
                 RowBox[{"xv", "[", "t", "]"}], ",", 
                 RowBox[{"kv", "[", "t", "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"kv", "[", "t", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
            "+", 
            RowBox[{
             RowBox[{
              RowBox[{"kv", "'"}], "[", "t", "]"}], "\[Cross]", 
             RowBox[{"\[CapitalOmega]", "[", 
              RowBox[{"\[Chi]", ",", 
               RowBox[{"kv", "[", "t", "]"}]}], "]"}]}]}]}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eq2", "[", "t_", "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"kv", "'"}], "[", "t", "]"}], "\[Equal]", 
           RowBox[{"-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", 
               RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", 
                RowBox[{"xv", "[", "t", "]"}], ",", 
                RowBox[{"kv", "[", "t", "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xv", "[", "t", "]"}], ",", "1"}], "}"}]}], "]"}]}]}],
           ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"set", " ", "initial", " ", "conditions"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eq4", ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kv", "[", "0", "]"}], "\[Equal]", "k0"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq3", ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xv", "[", "0", "]"}], "\[Equal]", "x0"}], ")"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"combine", " ", "the", " ", 
          RowBox[{"eq", "'"}], "s", " ", "defined", " ", "above", " ", "with",
           " ", "a", " ", "stopping", " ", "criterion"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tstop", "=", "\[Infinity]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"problem", "[", "t_", "]"}], ":=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "j"}], "]"}], "]"}], "\[Equal]", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "j"}], "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"eq1", "[", "t", "]"}], ",", 
               RowBox[{"eq2", "[", "t", "]"}], ",", "eq3", ",", "eq4"}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{
                   RowBox[{"x", "'"}], "[", "t", "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{
                   RowBox[{"y", "'"}], "[", "t", "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{
                   RowBox[{"z", "'"}], "[", "t", "]"}], "2"]}]], 
               "\[GreaterEqual]", "5"}], ",", 
              RowBox[{
               RowBox[{"tstop", "=", "t"}], ";", 
               "\"\<StopIntegration\>\""}]}], "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "numerically", " ", "solve", " ", "the", " ", "coupled", " ", 
          "differential", " ", "equation"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"solution", "[", "t_", "]"}], "=", 
         RowBox[{"First", "[", 
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"problem", "[", "t", "]"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xv", "[", "t", "]"}], ",", 
               RowBox[{"kv", "[", "t", "]"}]}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "ti", ",", "tf"}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "this", " ", "might", " ", "not", " ", "catch", " ", "all", " ", 
           "errors"}], ",", " ", 
          RowBox[{"but", " ", 
           RowBox[{"it", "'"}], "ll", " ", "do", " ", "for", " ", "the", " ", 
           "examples", " ", "in", " ", "this", " ", "notebook"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tstop", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"tstop", ",", "tf"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tstop", "<", "tf"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Watchout NDSolve -- tstop=\>\"", "<>", 
            RowBox[{"ToString", "[", "tstop", "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"return", "[", "t_", "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"xv", "[", "t", "]"}], "/.", 
            RowBox[{"solution", "[", "t", "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"kv", "[", "t", "]"}], "/.", 
            RowBox[{"solution", "[", "t", "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"return", "[", "s", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8753718139163637`*^9, 3.87537248883603*^9}, {
   3.875372521731038*^9, 3.875372598948813*^9}, {3.875372638071093*^9, 
   3.875372667444627*^9}, {3.875372723166608*^9, 3.875372725279752*^9}, {
   3.875372775786047*^9, 3.875372839413402*^9}, {3.87537298938726*^9, 
   3.875372996196085*^9}, {3.875373266701687*^9, 3.875373269475806*^9}, {
   3.8753740342706327`*^9, 3.875374062303205*^9}, {3.875374107478236*^9, 
   3.875374129561631*^9}, {3.8753742235618763`*^9, 3.875374288559656*^9}, {
   3.8753745212889833`*^9, 3.8753745214028177`*^9}, {3.8753745527154493`*^9, 
   3.8753745541002493`*^9}, {3.87537468585247*^9, 3.875374737670253*^9}, {
   3.8753749416599703`*^9, 3.875374942554412*^9}, {3.8753749973764257`*^9, 
   3.8753750783600807`*^9}, {3.875385775677775*^9, 3.8753860496047564`*^9}, {
   3.87538609156984*^9, 3.875386336073556*^9}, {3.8753867452336473`*^9, 
   3.875386763139112*^9}, 3.8753893224917*^9, 3.8753895341269903`*^9, {
   3.8753895909044533`*^9, 3.87538959120335*^9}, {3.875392584653295*^9, 
   3.875392610046296*^9}, {3.87539265307832*^9, 3.8753928085458117`*^9}, {
   3.875392870917982*^9, 3.875393012844138*^9}, {3.8753930547353086`*^9, 
   3.8753932657394238`*^9}, {3.875393308527615*^9, 3.8753934868131733`*^9}, {
   3.875393568798623*^9, 3.875393674799918*^9}, {3.87539373456922*^9, 
   3.875393906421476*^9}, {3.875394055285266*^9, 3.87539410019022*^9}, {
   3.875394147263425*^9, 3.875394218317411*^9}, {3.8754297523229313`*^9, 
   3.875429813412734*^9}, {3.875429913463326*^9, 3.8754299373395357`*^9}, {
   3.875610005315555*^9, 3.875610056741839*^9}, {3.875610418681381*^9, 
   3.875610418744589*^9}, 3.875610631099875*^9, {3.875610931587153*^9, 
   3.875610952400519*^9}, {3.875701282068931*^9, 3.875701335833992*^9}, {
   3.875701390734514*^9, 3.8757014500530787`*^9}, {3.8757014851493073`*^9, 
   3.875701490376498*^9}, {3.875701538720487*^9, 3.8757016382435913`*^9}, {
   3.875701682009058*^9, 3.875701738438554*^9}, {3.875701931633971*^9, 
   3.875702002830406*^9}, {3.875702037280258*^9, 3.875702180350152*^9}, {
   3.875702287017178*^9, 3.875702308255604*^9}, {3.8757175804769773`*^9, 
   3.8757176223524218`*^9}, 3.875717922657584*^9, {3.875719570359198*^9, 
   3.875719680025148*^9}, {3.875719970007078*^9, 3.875719989423703*^9}, {
   3.875720023744266*^9, 3.8757200836177692`*^9}, {3.87572011934797*^9, 
   3.875720188052978*^9}, {3.875720223638438*^9, 3.875720224402527*^9}, {
   3.876199546274818*^9, 3.87619958991718*^9}, {3.8762005183223143`*^9, 
   3.876200531014008*^9}, {3.876200562943416*^9, 3.876200571262085*^9}, {
   3.876200653525708*^9, 3.876200703673315*^9}, {3.87620085949335*^9, 
   3.8762008688634443`*^9}, {3.8762017617851057`*^9, 3.876202438947668*^9}, {
   3.8762025340809603`*^9, 3.8762025400643463`*^9}, {3.87620261709443*^9, 
   3.876202669832224*^9}, {3.8762027197741833`*^9, 3.876202730904736*^9}, {
   3.8762028556244097`*^9, 3.876202927107202*^9}, {3.876203001875944*^9, 
   3.876203043946033*^9}, {3.8762031327067633`*^9, 3.876203148035384*^9}, {
   3.8762032528849792`*^9, 3.876203262675536*^9}, {3.876209233851369*^9, 
   3.876209236504562*^9}, {3.8762112685729303`*^9, 3.876211309596569*^9}, {
   3.876211346880439*^9, 3.876211470947081*^9}, 3.876211731402624*^9, 
   3.876212046401372*^9, 3.8762121612878437`*^9, {3.876212215525592*^9, 
   3.876212247524146*^9}, {3.876212391383792*^9, 3.8762124905947*^9}, 
   3.876212543760313*^9, 3.876212765713426*^9, {3.876212959406522*^9, 
   3.876212959994162*^9}, {3.876213018074327*^9, 3.876213044438684*^9}, 
   3.876213090689808*^9, {3.8762132649719067`*^9, 3.876213276804166*^9}, 
   3.876214214167169*^9, {3.8762142974467373`*^9, 3.876214437745427*^9}, {
   3.876214667689506*^9, 3.876214721049564*^9}, {3.876214760241654*^9, 
   3.8762147721363792`*^9}, {3.876215351659543*^9, 3.876215417140147*^9}, {
   3.876215459066053*^9, 3.8762155730949163`*^9}, {3.876215612514304*^9, 
   3.87621574769133*^9}, 3.876216085475499*^9, {3.876216120107068*^9, 
   3.8762161246353683`*^9}, {3.876216664690085*^9, 3.876216665123727*^9}, {
   3.8762167172075768`*^9, 3.876216734773028*^9}, {3.876217319776656*^9, 
   3.8762173634314747`*^9}, {3.876278663197618*^9, 3.876278663752372*^9}, {
   3.876279664735392*^9, 3.876279675165155*^9}, {3.8762861288801317`*^9, 
   3.87628644839167*^9}, {3.8762969655162487`*^9, 3.876297027238597*^9}, {
   3.876372279038331*^9, 3.8763722834853373`*^9}, {3.876391067642168*^9, 
   3.876391091153441*^9}, {3.876391138881234*^9, 3.876391144434504*^9}, {
   3.876391224655499*^9, 3.876391228491456*^9}, {3.8763912902745333`*^9, 
   3.8763913010295277`*^9}, {3.8763913312444973`*^9, 3.876391350577849*^9}, {
   3.876391438056376*^9, 3.8763915012070007`*^9}, {3.876391578542211*^9, 
   3.8763915811039143`*^9}, {3.876391613774961*^9, 3.8763916138562803`*^9}, {
   3.876391678910523*^9, 3.8763916807994213`*^9}, {3.876391736937585*^9, 
   3.8763918200235233`*^9}, {3.876391873759432*^9, 3.876391893624824*^9}, {
   3.8763919738151417`*^9, 3.876391987899564*^9}, {3.87639211186754*^9, 
   3.87639214124658*^9}, {3.8763949285654497`*^9, 3.876395170928577*^9}, {
   3.876395805331493*^9, 3.876396028796269*^9}, {3.8763960600592833`*^9, 
   3.876396084704054*^9}, {3.876396254328445*^9, 3.876396257921694*^9}, {
   3.87639647434933*^9, 3.876396501191517*^9}, {3.876396618809451*^9, 
   3.8763966285658197`*^9}, {3.876396677693253*^9, 3.876396684601419*^9}, {
   3.876396743043913*^9, 3.876396743136544*^9}, {3.876396804582081*^9, 
   3.8763968432424593`*^9}, {3.8763984583003273`*^9, 3.87639848287786*^9}, {
   3.8763985186919928`*^9, 3.876398550987537*^9}, {3.8763986112464523`*^9, 
   3.876398611382667*^9}, {3.876398747694291*^9, 3.876398819063278*^9}, {
   3.876399485324885*^9, 3.8763994854302807`*^9}, {3.876816589865678*^9, 
   3.8768165924411783`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"8c845484-fbdb-440b-9c72-f8615d0ef9dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"random", " ", "test", " ", "case"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "xv", ",", "kv", ",", "x0", ",", "k0", ",", "s", ",", "t", ",", "vF", ",",
      "\[Alpha]", ",", "\[Chi]", ",", "ti", ",", "tf"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "k0"}], "}"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "5"}], ",", "5"}], "}"}], "]"}], ",", "0", ",", 
         "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", "0"}], "}"}]}],
       "}"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8753718139163637`*^9, 3.87537248883603*^9}, {
   3.875372521731038*^9, 3.875372598948813*^9}, {3.875372638071093*^9, 
   3.875372667444627*^9}, {3.875372723166608*^9, 3.875372725279752*^9}, {
   3.875372775786047*^9, 3.875372839413402*^9}, {3.87537298938726*^9, 
   3.875372996196085*^9}, {3.875373266701687*^9, 3.875373269475806*^9}, {
   3.8753740342706327`*^9, 3.875374062303205*^9}, {3.875374107478236*^9, 
   3.875374129561631*^9}, {3.8753742235618763`*^9, 3.875374288559656*^9}, {
   3.8753745212889833`*^9, 3.8753745214028177`*^9}, {3.8753745527154493`*^9, 
   3.8753745541002493`*^9}, {3.87537468585247*^9, 3.875374737670253*^9}, {
   3.8753749416599703`*^9, 3.875374942554412*^9}, {3.8753749973764257`*^9, 
   3.8753750783600807`*^9}, {3.875385775677775*^9, 3.8753860496047564`*^9}, {
   3.87538609156984*^9, 3.875386336073556*^9}, {3.8753867452336473`*^9, 
   3.875386763139112*^9}, 3.8753893224917*^9, 3.8753895341269903`*^9, {
   3.8753895909044533`*^9, 3.87538959120335*^9}, {3.875392584653295*^9, 
   3.875392610046296*^9}, {3.87539265307832*^9, 3.8753928085458117`*^9}, {
   3.875392870917982*^9, 3.875393012844138*^9}, {3.8753930547353086`*^9, 
   3.8753932657394238`*^9}, {3.875393308527615*^9, 3.8753934868131733`*^9}, {
   3.875393568798623*^9, 3.875393674799918*^9}, {3.87539373456922*^9, 
   3.875393906421476*^9}, {3.875394055285266*^9, 3.87539410019022*^9}, {
   3.875394147263425*^9, 3.875394218317411*^9}, {3.8754297523229313`*^9, 
   3.875429813412734*^9}, {3.875429913463326*^9, 3.8754299373395357`*^9}, {
   3.875610005315555*^9, 3.875610056741839*^9}, {3.875610418681381*^9, 
   3.875610418744589*^9}, 3.875610631099875*^9, {3.875610931587153*^9, 
   3.875610952400519*^9}, {3.875701282068931*^9, 3.875701335833992*^9}, {
   3.875701390734514*^9, 3.8757014500530787`*^9}, {3.8757014851493073`*^9, 
   3.875701490376498*^9}, {3.875701538720487*^9, 3.8757016382435913`*^9}, {
   3.875701682009058*^9, 3.875701738438554*^9}, {3.875701931633971*^9, 
   3.875702002830406*^9}, {3.875702037280258*^9, 3.875702180350152*^9}, {
   3.875702287017178*^9, 3.875702308255604*^9}, {3.8757175804769773`*^9, 
   3.8757176223524218`*^9}, 3.875717922657584*^9, {3.875719570359198*^9, 
   3.875719680025148*^9}, {3.875719970007078*^9, 3.875719989423703*^9}, {
   3.875720023744266*^9, 3.8757200836177692`*^9}, {3.87572011934797*^9, 
   3.875720188052978*^9}, {3.875720223638438*^9, 3.875720224402527*^9}, {
   3.876199546274818*^9, 3.87619958991718*^9}, {3.8762005183223143`*^9, 
   3.876200531014008*^9}, {3.876200562943416*^9, 3.876200571262085*^9}, {
   3.876200653525708*^9, 3.876200703673315*^9}, {3.87620085949335*^9, 
   3.8762008688634443`*^9}, {3.8762017617851057`*^9, 3.876202438947668*^9}, {
   3.8762025340809603`*^9, 3.8762025400643463`*^9}, {3.87620261709443*^9, 
   3.876202669832224*^9}, {3.8762027197741833`*^9, 3.876202730904736*^9}, {
   3.8762028556244097`*^9, 3.876202927107202*^9}, {3.876203001875944*^9, 
   3.876203043946033*^9}, {3.8762031327067633`*^9, 3.876203148035384*^9}, {
   3.8762032528849792`*^9, 3.876203262675536*^9}, {3.876209233851369*^9, 
   3.876209236504562*^9}, {3.8762112685729303`*^9, 3.876211309596569*^9}, {
   3.876211346880439*^9, 3.876211470947081*^9}, 3.876211731402624*^9, 
   3.876212046401372*^9, 3.8762121612878437`*^9, {3.876212215525592*^9, 
   3.876212247524146*^9}, {3.876212391383792*^9, 3.8762124905947*^9}, 
   3.876212543760313*^9, 3.876212765713426*^9, {3.876212959406522*^9, 
   3.876212959994162*^9}, {3.876213018074327*^9, 3.876213044438684*^9}, 
   3.876213090689808*^9, {3.8762132649719067`*^9, 3.876213276804166*^9}, 
   3.876214214167169*^9, {3.8762142974467373`*^9, 3.876214437745427*^9}, {
   3.876214667689506*^9, 3.876214721049564*^9}, {3.876214760241654*^9, 
   3.8762147721363792`*^9}, {3.876215351659543*^9, 3.876215417140147*^9}, {
   3.876215459066053*^9, 3.8762155730949163`*^9}, {3.876215612514304*^9, 
   3.87621574769133*^9}, 3.876216085475499*^9, {3.876216120107068*^9, 
   3.8762161246353683`*^9}, {3.876216664690085*^9, 3.876216665123727*^9}, {
   3.8762167172075768`*^9, 3.876216734773028*^9}, {3.876217319776656*^9, 
   3.8762173634314747`*^9}, {3.876278663197618*^9, 3.876278663752372*^9}, {
   3.876279664735392*^9, 3.876279675165155*^9}, {3.8762861288801317`*^9, 
   3.87628644839167*^9}, {3.8762969655162487`*^9, 3.876297027238597*^9}, {
   3.876372279038331*^9, 3.8763722834853373`*^9}, {3.876391067642168*^9, 
   3.876391091153441*^9}, {3.876391138881234*^9, 3.876391144434504*^9}, {
   3.876391224655499*^9, 3.876391228491456*^9}, {3.8763912902745333`*^9, 
   3.8763913010295277`*^9}, {3.8763913312444973`*^9, 3.876391350577849*^9}, {
   3.876391438056376*^9, 3.8763915012070007`*^9}, {3.876391578542211*^9, 
   3.8763915811039143`*^9}, {3.876391613774961*^9, 3.8763916138562803`*^9}, {
   3.876391678910523*^9, 3.8763916807994213`*^9}, {3.876391736937585*^9, 
   3.8763918200235233`*^9}, {3.876391873759432*^9, 3.876391893624824*^9}, {
   3.8763919738151417`*^9, 3.876391987899564*^9}, {3.87639211186754*^9, 
   3.87639214124658*^9}, {3.8763949285654497`*^9, 3.876395170928577*^9}, {
   3.876395805331493*^9, 3.876396028796269*^9}, {3.8763960600592833`*^9, 
   3.876396060442668*^9}, {3.876396104472725*^9, 3.876396109291532*^9}, {
   3.876396278380163*^9, 3.876396281581484*^9}, {3.8763963225950413`*^9, 
   3.876396323685813*^9}, {3.8763985818779173`*^9, 3.876398587080241*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"4f22d022-b777-4da8-bee6-99a5ec583125"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solveSEOM", "[", 
   RowBox[{
   "s", ",", "x0", ",", "k0", ",", "1", ",", "1", ",", "0.5", ",", "1", ",", 
    RowBox[{"ti", "=", 
     RowBox[{"-", "1000"}]}], ",", 
    RowBox[{"tf", "=", "1000"}]}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8753718139163637`*^9, 3.87537248883603*^9}, {
   3.875372521731038*^9, 3.875372598948813*^9}, {3.875372638071093*^9, 
   3.875372667444627*^9}, {3.875372723166608*^9, 3.875372725279752*^9}, {
   3.875372775786047*^9, 3.875372839413402*^9}, {3.87537298938726*^9, 
   3.875372996196085*^9}, {3.875373266701687*^9, 3.875373269475806*^9}, {
   3.8753740342706327`*^9, 3.875374062303205*^9}, {3.875374107478236*^9, 
   3.875374129561631*^9}, {3.8753742235618763`*^9, 3.875374288559656*^9}, {
   3.8753745212889833`*^9, 3.8753745214028177`*^9}, {3.8753745527154493`*^9, 
   3.8753745541002493`*^9}, {3.87537468585247*^9, 3.875374737670253*^9}, {
   3.8753749416599703`*^9, 3.875374942554412*^9}, {3.8753749973764257`*^9, 
   3.8753750783600807`*^9}, {3.875385775677775*^9, 3.8753860496047564`*^9}, {
   3.87538609156984*^9, 3.875386336073556*^9}, {3.8753867452336473`*^9, 
   3.875386763139112*^9}, 3.8753893224917*^9, 3.8753895341269903`*^9, {
   3.8753895909044533`*^9, 3.87538959120335*^9}, {3.875392584653295*^9, 
   3.875392610046296*^9}, {3.87539265307832*^9, 3.8753928085458117`*^9}, {
   3.875392870917982*^9, 3.875393012844138*^9}, {3.8753930547353086`*^9, 
   3.8753932657394238`*^9}, {3.875393308527615*^9, 3.8753934868131733`*^9}, {
   3.875393568798623*^9, 3.875393674799918*^9}, {3.87539373456922*^9, 
   3.875393906421476*^9}, {3.875394055285266*^9, 3.87539410019022*^9}, {
   3.875394147263425*^9, 3.875394218317411*^9}, {3.8754297523229313`*^9, 
   3.875429813412734*^9}, {3.875429913463326*^9, 3.8754299373395357`*^9}, {
   3.875610005315555*^9, 3.875610056741839*^9}, {3.875610418681381*^9, 
   3.875610418744589*^9}, 3.875610631099875*^9, {3.875610931587153*^9, 
   3.875610952400519*^9}, {3.875701282068931*^9, 3.875701335833992*^9}, {
   3.875701390734514*^9, 3.8757014500530787`*^9}, {3.8757014851493073`*^9, 
   3.875701490376498*^9}, {3.875701538720487*^9, 3.8757016382435913`*^9}, {
   3.875701682009058*^9, 3.875701738438554*^9}, {3.875701931633971*^9, 
   3.875702002830406*^9}, {3.875702037280258*^9, 3.875702180350152*^9}, {
   3.875702287017178*^9, 3.875702308255604*^9}, {3.8757175804769773`*^9, 
   3.8757176223524218`*^9}, 3.875717922657584*^9, {3.875719570359198*^9, 
   3.875719680025148*^9}, {3.875719970007078*^9, 3.875719989423703*^9}, {
   3.875720023744266*^9, 3.8757200836177692`*^9}, {3.87572011934797*^9, 
   3.875720188052978*^9}, {3.875720223638438*^9, 3.875720224402527*^9}, {
   3.876199546274818*^9, 3.87619958991718*^9}, {3.8762005183223143`*^9, 
   3.876200531014008*^9}, {3.876200562943416*^9, 3.876200571262085*^9}, {
   3.876200653525708*^9, 3.876200703673315*^9}, {3.87620085949335*^9, 
   3.8762008688634443`*^9}, {3.8762017617851057`*^9, 3.876202438947668*^9}, {
   3.8762025340809603`*^9, 3.8762025400643463`*^9}, {3.87620261709443*^9, 
   3.876202669832224*^9}, {3.8762027197741833`*^9, 3.876202730904736*^9}, {
   3.8762028556244097`*^9, 3.876202927107202*^9}, {3.876203001875944*^9, 
   3.876203043946033*^9}, {3.8762031327067633`*^9, 3.876203148035384*^9}, {
   3.8762032528849792`*^9, 3.876203262675536*^9}, {3.876209233851369*^9, 
   3.876209236504562*^9}, {3.8762112685729303`*^9, 3.876211309596569*^9}, {
   3.876211346880439*^9, 3.876211470947081*^9}, 3.876211731402624*^9, 
   3.876212046401372*^9, 3.8762121612878437`*^9, {3.876212215525592*^9, 
   3.876212247524146*^9}, {3.876212391383792*^9, 3.8762124905947*^9}, 
   3.876212543760313*^9, 3.876212765713426*^9, {3.876212959406522*^9, 
   3.876212959994162*^9}, {3.876213018074327*^9, 3.876213044438684*^9}, 
   3.876213090689808*^9, {3.8762132649719067`*^9, 3.876213276804166*^9}, 
   3.876214214167169*^9, {3.8762142974467373`*^9, 3.876214437745427*^9}, {
   3.876214667689506*^9, 3.876214721049564*^9}, {3.876214760241654*^9, 
   3.8762147721363792`*^9}, {3.876215351659543*^9, 3.876215417140147*^9}, {
   3.876215459066053*^9, 3.8762155730949163`*^9}, {3.876215612514304*^9, 
   3.87621574769133*^9}, 3.876216085475499*^9, {3.876216120107068*^9, 
   3.8762161246353683`*^9}, {3.876216664690085*^9, 3.876216665123727*^9}, {
   3.8762167172075768`*^9, 3.876216734773028*^9}, {3.876217319776656*^9, 
   3.8762173634314747`*^9}, {3.876278663197618*^9, 3.876278663752372*^9}, {
   3.876279664735392*^9, 3.876279675165155*^9}, {3.8762861288801317`*^9, 
   3.87628644839167*^9}, {3.8762969655162487`*^9, 3.876297027238597*^9}, {
   3.876372279038331*^9, 3.8763722834853373`*^9}, {3.876391067642168*^9, 
   3.876391091153441*^9}, {3.876391138881234*^9, 3.876391144434504*^9}, {
   3.876391224655499*^9, 3.876391228491456*^9}, {3.8763912902745333`*^9, 
   3.8763913010295277`*^9}, {3.8763913312444973`*^9, 3.876391350577849*^9}, {
   3.876391438056376*^9, 3.8763915012070007`*^9}, {3.876391578542211*^9, 
   3.8763915811039143`*^9}, {3.876391613774961*^9, 3.8763916138562803`*^9}, {
   3.876391678910523*^9, 3.8763916807994213`*^9}, {3.876391736937585*^9, 
   3.8763918200235233`*^9}, {3.876391873759432*^9, 3.876391893624824*^9}, {
   3.8763919738151417`*^9, 3.876391987899564*^9}, {3.87639211186754*^9, 
   3.87639214124658*^9}, {3.8763949285654497`*^9, 3.876395170928577*^9}, {
   3.876395805331493*^9, 3.876396028796269*^9}, {3.8763960600592833`*^9, 
   3.876396060442668*^9}, {3.876396104472725*^9, 3.876396109291532*^9}, {
   3.876396278380163*^9, 3.876396308989497*^9}, {3.876396702588406*^9, 
   3.876396726764045*^9}, 3.876396768085444*^9, {3.876396839058584*^9, 
   3.876396839140345*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"f2a61410-9d2d-4663-9dde-d0f4096b7917"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting", "Subsubsection",
 CellChangeTimes->{{3.876278461749938*^9, 
  3.876278464783457*^9}},ExpressionUUID->"7ef52e73-a8a0-414d-bc87-\
366b20317915"],

Cell[BoxData[{
 RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ParametricPlot", ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"LogLinearPlot", ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"LogLogPlot", ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlot", ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLogLinearPlot", ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"ListLogLogPlot", ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "makePlots", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makePlots", "[", 
    RowBox[{
    "\[Rho]t_", ",", "\[Alpha]_", ",", "\[Chi]_", ",", "xk_", ",", "ti_", ",",
      "tf_", ",", 
     RowBox[{"print_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "allPlots", ",", "photonSphere", ",", "photonCylinder", ",", "inset", 
       ",", "trajXV", ",", "trajDTXV", ",", "trajKV", ",", "angMom", ",", 
       "sPlot", ",", "totAngMom", ",", "dtTotAngMom", ",", "dtJLSZ", ",", "t",
        ",", "tpr"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"photonSphere", "=", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sphere", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "#"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"\[Rho]t", ",", 
           RowBox[{"\[Rho]t", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Alpha]"}], ")"}], 
             FractionBox["1", 
              RowBox[{"2", "\[Alpha]"}]]]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"photonCylinder", "=", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cylinder", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xk", "[", "#", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "tf"}], "}"}]}], ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Alpha]"}], ")"}], 
            FractionBox["1", 
             RowBox[{"2", "\[Alpha]"}]]]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Rho]", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"inset", "=", "photonSphere"}], ",", 
        RowBox[{"inset", "=", "photonCylinder"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"trajXV", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"xk", "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], ",", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Tube", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"xk", "[", "t", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"{", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"tf", "+", "ti"}], "2"], ",", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"tf", "+", "ti"}], "2"], "+", 
                   RowBox[{"0.001", "*", 
                    RowBox[{"(", 
                    RowBox[{"tf", "-", "ti"}], ")"}]}]}]}], "}"}]}], "}"}]}], 
             "]"}], "]"}], "]"}], "]"}], ",", "inset", ",", 
         RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", "\"\<\\\\text{spatial trajectory}\>\"", "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"trajDTXV", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"xk", "'"}], "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}]}], "]"}], ",", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Tube", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"xk", "'"}], "[", "t", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"{", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"tf", "+", "ti"}], "2"], ",", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"tf", "+", "ti"}], "2"], "+", 
                   RowBox[{"0.001", "*", 
                    RowBox[{"(", 
                    RowBox[{"tf", "-", "ti"}], ")"}]}]}]}], "}"}]}], "}"}]}], 
             "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", "\"\<\\\\text{velocity trajectory}\>\"", "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"trajKV", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"xk", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}]}], "]"}], ",", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Tube", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"xk", "[", "t", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"{", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"tf", "+", "ti"}], "2"], ",", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"tf", "+", "ti"}], "2"], "+", 
                   RowBox[{"0.001", "*", 
                    RowBox[{"(", 
                    RowBox[{"tf", "-", "ti"}], ")"}]}]}]}], "}"}]}], "}"}]}], 
             "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", "\"\<\\\\text{momentum trajectory}\>\"", "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"angMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"L", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"xk", "[", "t", "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", "\"\<\\\\text{Angular moment}\>\"", "]"}]}], 
         ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<L_x\>\"", ",", "\"\<L_y\>\"", ",", "\"\<L_z\>\""}], 
            "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sPlot", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"spin", "[", 
           RowBox[{"\[Chi]", ",", 
            RowBox[{
             RowBox[{"xk", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", "\"\<\\\\text{Spin}\>\"", "]"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<s_x\>\"", ",", "\"\<s_y\>\"", ",", "\"\<s_z\>\""}], 
            "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"totAngMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"J", "[", 
           RowBox[{"\[Chi]", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"xk", "[", "t", "]"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", "\"\<\\\\text{Total angular moment}\>\"", "]"}]}], 
         ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<J_x\>\"", ",", "\"\<J_y\>\"", ",", "\"\<J_z\>\""}], 
            "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dtTotAngMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{"\[Chi]", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"xk", "[", "t", "]"}]}]}], "]"}], ",", "tpr"}], "]"}],
            "/.", 
           RowBox[{"{", 
            RowBox[{"tpr", "\[Rule]", "t"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", 
           "\"\<\\\\text{Time derivative of total angular moment}\>\"", 
           "]"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\\\\dot J_x\>\"", ",", "\"\<\\\\dot J_y\>\"", ",", 
             "\"\<\\\\dot J_z\>\""}], "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dtJLSZ", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"spin", "[", 
                 RowBox[{"\[Chi]", ",", 
                  RowBox[{
                   RowBox[{"xk", "[", "tpr", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "tpr"}], 
               "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"L", "[", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"xk", "[", "tpr", "]"}]}], "]"}], ",", "tpr"}], 
               "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"J", "[", 
                 RowBox[{"\[Chi]", ",", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"xk", "[", "t", "]"}]}]}], "]"}], ",", "tpr"}], 
               "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
           RowBox[{"{", 
            RowBox[{"tpr", "\[Rule]", "t"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", 
           "\"\<\\\\text{Time derivative of z-components of $\\\\bf J$, \
$\\\\bf L$ and $\\\\bf S$}\>\"", "]"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\\\\dot s_z\>\"", ",", "\"\<\\\\dot L_z\>\"", ",", 
             "\"\<\\\\dot J_z\>\""}], "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allPlots", "=", 
       RowBox[{"{", 
        RowBox[{
        "trajXV", ",", "trajDTXV", ",", "trajKV", ",", "angMom", ",", "sPlot",
          ",", "totAngMom", ",", "dtTotAngMom", ",", "dtJLSZ"}], "}"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"print", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Print", "[", "#", "]"}], "&"}], "/@", "allPlots"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "allPlots"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQ/WQHg2TWwzeOPB6yxiB6xRZpaxAdxsXtCaIvej/1
AdHPYtKCQPTB+l8RIPqlhl4siD6s8z8RRC+Tz0kF0SrG8lkg+iyLRD6ItmF6
WQKiA7bI1ILoxPz9E0F0i/6yBSBaKlB1FYhmenwYTC8493A9iN51QnAviA76
9PIOiA5kMX8Covn/r1TNBdJCVjPUQbR+Zc+KPCBtbrJ8PYie5ruzvBhkH29D
DYguOVT7dDqQXjPpNZi24TruPxNIP//vFgSiL4l9X7EYSBubtq0B0Qaf/L+D
aI67R3iXAGlbi00yIPrO8RUKILrk/sUSEP3M27AURNub264F0SviDoBp+YXh
x0D0jDNp50A0AA+Dxfo=
  "],
 CellLabel->"In[87]:=",ExpressionUUID->"8993ef5f-aa5a-4840-baed-a3ef0d44ff0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"random", " ", "test", " ", "case"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"x0", ",", "k0", ",", "s", ",", "t"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "k0"}], "}"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"8", "+", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}], "]"}]}], ",", "0", ",", 
         "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", "0"}], "}"}]}],
       "}"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/WQHg2TWwzeOPB6yxiB6xRZpaxAdxsXtCaIvej/1
AdHPYtKCQPTB+l8RIPqlhl4siD6s8z8RRC+Tz0kF0SrG8lkg+iyLRD6ItmF6
WQKiA7bI1ILoxPz9E0F0i/6yBSBaKlB1FYhmenwYTC8493A9iN51QnAviA76
9PIOiA5kMX8Covn/r1TNBdJCVjPUQbR+Zc+KPCBtbrJ8PYie5ruzvBhkH29D
DYguOVT7dDqQXjPpNZi24TruPxNIP//vFgSiL4l9X7EYSBubtq0B0Qaf/L+D
aI67R3iXAGlbi00yIPrO8RUKILrk/sUSEN0VMb0cRAMAhIyzAQ==
  "],
 CellLabel->"In[97]:=",ExpressionUUID->"07001438-fc15-4819-b89d-bdc34fe5fe08"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"fun", ",", "s"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fun", "[", "s_", "]"}], "=", 
   RowBox[{"solveSEOM", "[", 
    RowBox[{"s", ",", "x0", ",", "k0", ",", 
     RowBox[{"vF", "=", "1"}], ",", 
     RowBox[{"\[Rho]t", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.5"}], ",", 
     RowBox[{"\[Chi]", "=", 
      RowBox[{"+", "1"}]}], ",", 
     RowBox[{"ti", "=", 
      RowBox[{"-", "100"}]}], ",", 
     RowBox[{"tf", "=", "100"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"makePlots", "[", 
   RowBox[{
   "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "fun", ",", "ti", ",", 
    "tf"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/WQHg2TWwzeOPB6yxiB6xRZpaxAdxsXtCaIvej/1
AdHPYtKCQPTB+l8RIPqlhl4siD6s8z8RRC+Tz0kF0SrG8lkg+iyLRD6ItmF6
WQKiA7bI1ILoxPz9E0F0i/6yBSBaKlB1FYhmenwYTC8493A9iN51QnAviA76
9PIOiA5kMX8Covn/r1TNBdJCVjPUQbR+Zc+KPCBtbrJ8PYie5ruzvBhkH29D
DYguOVT7dDqQXjPpNZi24TruPxNIP//vFgSiL4l9X7EYSBubtq0B0Qaf/L+D
aI67R3iXAGlbi00yIPrO8RUKILrk/sUSEH1g/4QKEJ2XWXwBRB+puAimDS9m
vS54BHT/1Nz3IPrU+10/QfRR7c5fIBoAMLPS0w==
  "],
 CellLabel->
  "In[199]:=",ExpressionUUID->"c1f8ba6c-be24-45f4-8e20-fdef409918cf"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "makePlots2D", ",", "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "xk", 
   ",", "ti", ",", "tf", ",", "ax1", ",", "ax2", ",", "print"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makePlots2D", "[", 
    RowBox[{
    "\[Rho]t_", ",", "\[Alpha]_", ",", "\[Chi]_", ",", "xk_", ",", "ti_", ",",
      "tf_", ",", 
     RowBox[{"ax1_", ":", "1"}], ",", 
     RowBox[{"ax2_", ":", "2"}], ",", 
     RowBox[{"print_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "allPlots", ",", "photonSphere", ",", "photonCylinder", ",", "inset", 
       ",", "trajXV", ",", "trajDTXV", ",", "trajKV", ",", "angMom", ",", 
       "sPlot", ",", "totAngMom", ",", "dtTotAngMom", ",", "dtJLSZ", ",", "t",
        ",", "tpr"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inset", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ax1", ",", "ax2"}], "}"}], "\[Equal]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "||", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ax1", ",", "ax2"}], "}"}], "\[Equal]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}]}]}], ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
              RowBox[{"Disk", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", "#"}], "]"}]}], "}"}], 
            "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"\[Rho]t", ",", 
             RowBox[{"\[Rho]t", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", "\[Alpha]"}], ")"}], 
               FractionBox["1", 
                RowBox[{"2", "\[Alpha]"}]]]}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"trajXV", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"xk", "[", "t", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"ax1", ",", "ax2"}], "}"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
              "}"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"ax1", ",", "ax2"}], "}"}], "]"}], "]"}]}]}], "]"}], 
         ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Line", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"xk", "[", "t", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"ax1", ",", "ax2"}], "}"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"{", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"tf", "+", "ti"}], "2"], ",", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"tf", "+", "ti"}], "2"], "+", 
                   RowBox[{"0.001", "*", 
                    RowBox[{"(", 
                    RowBox[{"tf", "-", "ti"}], ")"}]}]}]}], "}"}]}], "}"}]}], 
             "]"}], "]"}], "]"}], "]"}], ",", "inset", ",", 
         RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", "\"\<\\\\text{spatial trajectory}\>\"", "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"trajDTXV", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"xk", "'"}], "[", "t", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"ax1", ",", "ax2"}], "}"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
              "}"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"ax1", ",", "ax2"}], "}"}], "]"}], "]"}]}]}], "]"}], 
         ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Line", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"xk", "'"}], "[", "t", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"ax1", ",", "ax2"}], "}"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"{", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"tf", "+", "ti"}], "2"], ",", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"tf", "+", "ti"}], "2"], "+", 
                   RowBox[{"0.001", "*", 
                    RowBox[{"(", 
                    RowBox[{"tf", "-", "ti"}], ")"}]}]}]}], "}"}]}], "}"}]}], 
             "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", "\"\<\\\\text{velocity trajectory}\>\"", "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"trajKV", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"xk", "[", "t", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"ax1", ",", "ax2"}], "}"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
              "}"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"ax1", ",", "ax2"}], "}"}], "]"}], "]"}]}]}], "]"}], 
         ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Line", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"xk", "[", "t", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"ax1", ",", "ax2"}], "}"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"{", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"tf", "+", "ti"}], "2"], ",", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"tf", "+", "ti"}], "2"], "+", 
                   RowBox[{"0.001", "*", 
                    RowBox[{"(", 
                    RowBox[{"tf", "-", "ti"}], ")"}]}]}]}], "}"}]}], "}"}]}], 
             "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", "\"\<\\\\text{momentum trajectory}\>\"", "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"angMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"L", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"xk", "[", "t", "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", "\"\<\\\\text{Angular moment}\>\"", "]"}]}], 
         ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<L_x\>\"", ",", "\"\<L_y\>\"", ",", "\"\<L_z\>\""}], 
            "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sPlot", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"spin", "[", 
           RowBox[{"\[Chi]", ",", 
            RowBox[{
             RowBox[{"xk", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", "\"\<\\\\text{Spin}\>\"", "]"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<s_x\>\"", ",", "\"\<s_y\>\"", ",", "\"\<s_z\>\""}], 
            "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"totAngMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"J", "[", 
           RowBox[{"\[Chi]", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"xk", "[", "t", "]"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", "\"\<\\\\text{Total angular moment}\>\"", "]"}]}], 
         ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<J_x\>\"", ",", "\"\<J_y\>\"", ",", "\"\<J_z\>\""}], 
            "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dtTotAngMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{"\[Chi]", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"xk", "[", "tpr", "]"}]}]}], "]"}], ",", "tpr"}], 
            "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"tpr", "\[Rule]", "t"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", 
           "\"\<\\\\text{Time derivative of total angular moment}\>\"", 
           "]"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\\\\dot J_x\>\"", ",", "\"\<\\\\dot J_y\>\"", ",", 
             "\"\<\\\\dot J_z\>\""}], "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dtJLSZ", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"spin", "[", 
                 RowBox[{"\[Chi]", ",", 
                  RowBox[{
                   RowBox[{"xk", "[", "tpr", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "tpr"}], 
               "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"L", "[", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"xk", "[", "tpr", "]"}]}], "]"}], ",", "tpr"}], 
               "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"J", "[", 
                 RowBox[{"\[Chi]", ",", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"xk", "[", "t", "]"}]}]}], "]"}], ",", "tpr"}], 
               "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
           RowBox[{"{", 
            RowBox[{"tpr", "\[Rule]", "t"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tf"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "MaTeX", "[", 
           "\"\<\\\\text{Time derivative of z-components of $\\\\bf J$, \
$\\\\bf L$ and $\\\\bf S$}\>\"", "]"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\\\\dot s_z\>\"", ",", "\"\<\\\\dot L_z\>\"", ",", 
             "\"\<\\\\dot J_z\>\""}], "}"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"{", "\"\<\\\\text{time (a.u.)}\>\"", "}"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allPlots", "=", 
       RowBox[{"{", 
        RowBox[{
        "trajXV", ",", "trajDTXV", ",", "trajKV", ",", "angMom", ",", "sPlot",
          ",", "totAngMom", ",", "dtTotAngMom", ",", "dtJLSZ"}], "}"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"print", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Print", "[", "#", "]"}], "&"}], "/@", "allPlots"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "allPlots"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8762784720225697`*^9, 3.876278680915045*^9}, {
   3.876278744865803*^9, 3.8762788563450117`*^9}, {3.876278887165505*^9, 
   3.87627893119884*^9}, {3.876278983828095*^9, 3.876279017442494*^9}, {
   3.876279055974214*^9, 3.8762790833788633`*^9}, {3.8762791209749928`*^9, 
   3.876279160750586*^9}, {3.8762792072815228`*^9, 3.876279272897011*^9}, {
   3.876279437982346*^9, 3.8762795571933002`*^9}, {3.87627963316615*^9, 
   3.876279638121461*^9}, {3.876279679056473*^9, 3.8762797845557528`*^9}, {
   3.87628003931083*^9, 3.876280097719277*^9}, {3.876284717312385*^9, 
   3.8762847327570887`*^9}, {3.876287812389793*^9, 3.876287869225124*^9}, {
   3.876297661790721*^9, 3.876297700001625*^9}, {3.876372267929987*^9, 
   3.8763722713616543`*^9}, {3.8763751662199993`*^9, 3.876375186218738*^9}, {
   3.8763963597215357`*^9, 3.876396388193994*^9}, {3.876398046127877*^9, 
   3.876398149609194*^9}, 3.8763982983150873`*^9, {3.87639891238721*^9, 
   3.876398950768055*^9}, {3.876399031203125*^9, 3.8763990910400248`*^9}, {
   3.876816641438718*^9, 3.87681664752248*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"32b1e47c-a4b0-4d8a-9e85-6e3c67104036"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"random", " ", "test", " ", "case"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"x0", ",", "k0", ",", "s", ",", "t"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "k0"}], "}"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"8", "+", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}], "]"}]}], ",", "0", ",", 
         "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", "0"}], "}"}]}],
       "}"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/WQHg2TWwzeOPB6yxiB6xRZpaxAdxsXtCaIvej/1
AdHPYtKCQPTB+l8RIPqlhl4siD6s8z8RRC+Tz0kF0SrG8lkg+iyLRD6ItmF6
WQKiA7bI1ILoxPz9E0F0i/6yBSBaKlB1FYhmenwYTC8493A9iN51QnAviA76
9PIOiA5kMX8Covn/r1TNBdJCVjPUQbR+Zc+KPCBtbrJ8PYie5ruzvBhkH29D
DYguOVT7dDqQXjPpNZi24TruPxNIP//vFgSiL4l9X7EYSBubtq0B0Qaf/L+D
aI67R3iXAGlbi00yIPrO8RUKILrk/sUSEN0VMb0cRFfNTflW8OiNY1J4I5gG
AAesvKE=
  "],
 CellLabel->
  "In[173]:=",ExpressionUUID->"b22d2150-4be4-4b8d-b995-000b319fdb10"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"fun", ",", "s"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fun", "[", "s_", "]"}], "=", 
    RowBox[{"solveSEOM", "[", 
     RowBox[{"s", ",", "x0", ",", "k0", ",", 
      RowBox[{"vF", "=", "1"}], ",", 
      RowBox[{"\[Rho]t", "=", "1"}], ",", 
      RowBox[{"\[Alpha]", "=", "0.5"}], ",", 
      RowBox[{"\[Chi]", "=", 
       RowBox[{"+", "1"}]}], ",", 
      RowBox[{"ti", "=", 
       RowBox[{"-", "100"}]}], ",", 
      RowBox[{"tf", "=", "100"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makePlots2D", "[", 
    RowBox[{
    "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "fun", ",", "ti", ",", 
     "tf", ",", 
     RowBox[{"ax1", "=", "1"}], ",", 
     RowBox[{"ax2", "=", "2"}], ",", 
     RowBox[{"print", "=", "True"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8762784720225697`*^9, 3.876278680915045*^9}, {
   3.876278744865803*^9, 3.8762788563450117`*^9}, {3.876278887165505*^9, 
   3.87627893119884*^9}, {3.876278983828095*^9, 3.876279017442494*^9}, {
   3.876279055974214*^9, 3.8762790833788633`*^9}, {3.8762791209749928`*^9, 
   3.876279160750586*^9}, {3.8762792072815228`*^9, 3.876279272897011*^9}, {
   3.876279437982346*^9, 3.8762795571933002`*^9}, {3.87627963316615*^9, 
   3.876279638121461*^9}, {3.876279679056473*^9, 3.8762797845557528`*^9}, {
   3.87628003931083*^9, 3.876280097719277*^9}, {3.876284717312385*^9, 
   3.8762847327570887`*^9}, {3.876287812389793*^9, 3.876287869225124*^9}, {
   3.876297661790721*^9, 3.876297700001625*^9}, {3.876372267929987*^9, 
   3.8763722713616543`*^9}, {3.8763751662199993`*^9, 3.876375186218738*^9}, {
   3.8763963597215357`*^9, 3.876396388193994*^9}, {3.876396986498314*^9, 
   3.8763971661519814`*^9}, {3.876397285569365*^9, 3.876397317274397*^9}, {
   3.876397990558527*^9, 3.8763980419681177`*^9}, {3.876398163925893*^9, 
   3.876398212459087*^9}, 3.876398257545251*^9, {3.8763991077704763`*^9, 
   3.876399107913562*^9}, {3.876816685467291*^9, 3.87681669537068*^9}, {
   3.8768167889471073`*^9, 3.876816834191637*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"94eb6e50-e931-4e98-94d0-5d435172058c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Lensing Angle", "Subsubsection",
 CellChangeTimes->{{3.876298694559404*^9, 
  3.876298697801196*^9}},ExpressionUUID->"8a19a71f-2c87-4dfe-acc9-\
c9c236223541"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "lensingAngle", ",", "x0", ",", "k0", ",", "fun", ",", "vF", ",", "rt", ",",
    "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "nti", ",", "ntf", ",", 
   "ti", ",", "tf", ",", "t"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lensingAngle", "[", 
     RowBox[{
     "x0_", ",", "k0_", ",", "vF_", ",", "rt_", ",", "\[Alpha]_", ",", 
      "\[Chi]_", ",", "nti_", ",", "ntf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", "b", ",", "fun", ",", "ti", ",", "tf", ",", "rp", ",", 
        "plots", ",", "closestApproach", ",", "tp", ",", "\[Epsilon]p", ",", 
        "Lzp", ",", "\[Epsilon]diff", ",", "Lzdiff", ",", "\[Epsilon]ts", ",",
         "Lzts", ",", "xvts", ",", "lensingAngleNumeric", ",", 
        "lensingAngleAnalytic1", ",", "lensingAngleAnalytic2", ",", 
        "lensingPlot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ti", "=", "nti"}], ";", 
       RowBox[{"tf", "=", "ntf"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "obtain", " ", "solution", " ", "with", " ", "initial", " ", 
          "conditions", " ", "x0"}], ",", " ", "k0"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fun", "[", "b_", "]"}], ":=", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"solveSEOM", "[", 
          RowBox[{
          "b", ",", "x0", ",", "k0", ",", "vF", ",", "rt", ",", "\[Alpha]", 
           ",", "\[Chi]", ",", "ti", ",", "tf"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "periapsis"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"closestApproach", "[", "b_", "]"}], "=", 
        RowBox[{"NMinimize", "[", 
         RowBox[{
          RowBox[{"norm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fun", "[", "b", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", "2"}], "]"}], "]"}], "]"}], ",", "b"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rp", "=", 
        RowBox[{"First", "[", 
         RowBox[{"closestApproach", "[", "t", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", 
         RowBox[{"ToString", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Periapsis: `1`\>\"", ",", "\[Rho]p"}], "]"}], "]"}], 
         "]"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tp", "=", 
        RowBox[{"t", "/.", 
         RowBox[{
          RowBox[{"closestApproach", "[", "t", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Epsilon]ts", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"fun", "[", "#", "]"}]}]}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "tf"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Epsilon]diff", "=", 
        RowBox[{"Subtract", "@@", "\[Epsilon]ts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Lzts", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"L", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"fun", "[", "#", "]"}]}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "tf"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Lzdiff", "=", 
        RowBox[{"Subtract", "@@", "Lzts"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"\[Epsilon]diff", "/", 
            RowBox[{"\[Epsilon]ts", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], ",", 
         RowBox[{"Print", "[", "\"\<Check conserved quantities.\>\"", "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Lzdiff", "/", 
            RowBox[{"Lzts", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], ",", 
         RowBox[{"Print", "[", "\"\<Check conserved quantities.\>\"", "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", 
         RowBox[{"initial", "/", "final"}], " ", "direction", " ", "vector"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"xvts", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fun", "'"}], "[", "#", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "tf"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lensingAngleNumeric", "=", 
        RowBox[{"VectorAngle", "@@", "xvts"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"compare", " ", "to", " ", "analytics"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"lensingAngleAnalytic1", "=", 
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"vF", "/", 
              RowBox[{"(", 
               RowBox[{"\[Sqrt]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", 
                    SuperscriptBox["rp", "2"]], 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["vF", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"u", "[", 
                    RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", "rp"}], 
                    "]"}], "2"]}], ")"}], 
                   SuperscriptBox["r", "4"]}], "-", 
                  RowBox[{
                   SuperscriptBox["r", "2"], 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["vF", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"u", "[", 
                    RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", "r"}], 
                    "]"}], "2"]}], ")"}]}]}], ")"}]}], ")"}]}], ")"}]}], ",", 
           
           RowBox[{"{", 
            RowBox[{"r", ",", "rp", ",", "\[Infinity]"}], "}"}]}], "]"}], "-",
          "\[Pi]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lensingAngleAnalytic2", "=", 
        RowBox[{
         FractionBox[
          SuperscriptBox[
           RowBox[{"u", "[", 
            RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", "rp"}], "]"}], 
           "2"], 
          SuperscriptBox["vF", "2"]], 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "-", 
               RowBox[{
                SuperscriptBox["rp", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox["rp", "r"], ")"}], 
                 RowBox[{"2", "\[Alpha]"}]]}]}], ")"}], 
             RowBox[{
              SuperscriptBox["r", "2"], "-", 
              SuperscriptBox["rp", "2"]}]], 
            FractionBox["rp", 
             RowBox[{"r", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["r", "2"], "-", 
                SuperscriptBox["rp", "2"]}]]}]]}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "rp", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "result", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "rp", ",", "lensingAngleNumeric", ",", "lensingAngleAnalytic1", ",", 
         "lensingAngleAnalytic2"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"random", " ", "test", " ", "case"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "xv", ",", "kv", ",", "x0", ",", "k0", ",", "s", ",", "t", ",", "vF", ",", 
   "\[Alpha]", ",", "\[Chi]", ",", "ti", ",", "tf"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x0", ",", "k0"}], "}"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3.5", "+", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", "0"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lensingAngle", "[", 
   RowBox[{"x0", ",", "k0", ",", "1", ",", "1", ",", 
    RowBox[{"1", "/", "2"}], ",", "1", ",", 
    RowBox[{"-", "200"}], ",", "200"}], "]"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8762994227929077`*^9, 3.8762994233079433`*^9}, {
   3.876299878318181*^9, 3.876299882582816*^9}, {3.8763004780918617`*^9, 
   3.876300478918247*^9}, {3.8763843794979887`*^9, 3.87638437957813*^9}, {
   3.8763921770034122`*^9, 3.876392223749179*^9}, {3.876399153204296*^9, 
   3.876399166645954*^9}, {3.876399222344988*^9, 3.876399407002287*^9}, 
   3.876399449402663*^9, {3.876399496871484*^9, 3.876399699372666*^9}, {
   3.8763998632833433`*^9, 3.876399907115279*^9}},
 CellLabel->
  "In[398]:=",ExpressionUUID->"2eb269a6-aef2-4b4e-8628-13f5f2b3580e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Transverse Shift", "Subsubsection",
 CellChangeTimes->{{3.8763722398352337`*^9, 
  3.876372243636908*^9}},ExpressionUUID->"5a03dbae-22f6-4134-950d-\
a2d224cabd7f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "transverseShift", ",", "x0", ",", "k0", ",", "vF", ",", "rt", ",", 
   "\[Alpha]", ",", "\[Chi]", ",", "nti", ",", "ntf", ",", "t"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"transverseShift", "[", 
     RowBox[{
     "x0_", ",", "k0_", ",", "vF_", ",", "rt_", ",", "\[Alpha]_", ",", 
      "\[Chi]_", ",", "nti_", ",", "ntf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", "b", ",", "fun", ",", "ti", ",", "tf", ",", "\[Rho]p", ",", 
        "plots", ",", "closestApproach", ",", "tp", ",", "\[Epsilon]p", ",", 
        "Lzp", ",", "\[Epsilon]diff", ",", "Lzdiff", ",", "\[Epsilon]ts", ",",
         "Lzts", ",", "xvts", ",", "a", ",", "\[CapitalDelta]zNumeric", ",", 
        "f", ",", "\[CapitalDelta]zAnalytic1", ",", 
        "\[CapitalDelta]zAnalytic2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ti", "=", "nti"}], ";", 
       RowBox[{"tf", "=", "ntf"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "obtain", " ", "solution", " ", "with", " ", "initial", " ", 
          "conditions", " ", "x0"}], ",", " ", "k0"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fun", "[", "b_", "]"}], ":=", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"solveSEOM", "[", 
          RowBox[{
          "b", ",", "x0", ",", "k0", ",", "vF", ",", "rt", ",", "\[Alpha]", 
           ",", "\[Chi]", ",", "ti", ",", "tf"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "periapsis"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"closestApproach", "[", "b_", "]"}], "=", 
        RowBox[{"NMinimize", "[", 
         RowBox[{
          RowBox[{"norm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fun", "[", "b", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", "2"}], "]"}], "]"}], "]"}], ",", "b"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Rho]p", "=", 
        RowBox[{"First", "[", 
         RowBox[{"closestApproach", "[", "t", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", 
         RowBox[{"ToString", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Periapsis: `1`\>\"", ",", "\[Rho]p"}], "]"}], "]"}], 
         "]"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tp", "=", 
        RowBox[{"t", "/.", 
         RowBox[{
          RowBox[{"closestApproach", "[", "t", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Epsilon]ts", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"fun", "[", "#", "]"}]}]}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "tf"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Epsilon]diff", "=", 
        RowBox[{"Subtract", "@@", "\[Epsilon]ts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Lzts", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"L", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"fun", "[", "#", "]"}]}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "tf"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Lzdiff", "=", 
        RowBox[{"Subtract", "@@", "Lzts"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"u", "[", 
            RowBox[{"\[Alpha]", ",", "vF", ",", "rt", ",", "\[Rho]p"}], "]"}],
            "vF"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]zNumeric", " ", "=", " ", 
        RowBox[{"Subtract", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"fun", "[", "#", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"tf", ",", "ti"}], "}"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", "s_", "]"}], ":=", 
        RowBox[{
         FractionBox[
          SuperscriptBox["s", 
           RowBox[{"1", "-", 
            RowBox[{"2", "\[Alpha]"}]}]], 
          SqrtBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "a"}], ")"}], 
             SuperscriptBox["s", "2"]}], "-", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"a", " ", 
               SuperscriptBox["s", 
                RowBox[{
                 RowBox[{"-", "2"}], "\[Alpha]"}]]}]}], ")"}]}]]], 
         FractionBox[
          RowBox[{"2", "-", 
           RowBox[{"a", " ", 
            SuperscriptBox["s", 
             RowBox[{
              RowBox[{"-", "2"}], "\[Alpha]"}]]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "a"}], ")"}], 
            SuperscriptBox["s", "2"]}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "a"}], ")"}], 
              SuperscriptBox["s", "2"]}], "+", 
             RowBox[{"a", " ", 
              SuperscriptBox["s", 
               RowBox[{
                RowBox[{"-", "2"}], "\[Alpha]"}]]}]}], ")"}], "2"]]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]zAnalytic1", " ", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Chi]", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Alpha]"}], ")"}], "\[Rho]p", " "}], 
           RowBox[{"Lzts", "[", 
            RowBox[{"[", "1", "]"}], "]"}]]}], "a", 
         SqrtBox[
          RowBox[{"1", "-", "a"}]], 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"f", "[", "s", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]zAnalytic2", " ", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Chi]", " ", "\[Rho]p", " "}], 
           RowBox[{"Lzts", "[", 
            RowBox[{"[", "1", "]"}], "]"}]]}], 
         FractionBox[
          RowBox[{" ", 
           RowBox[{
            SqrtBox["\[Pi]"], 
            RowBox[{"Gamma", "[", 
             RowBox[{
              FractionBox["1", "2"], "+", "\[Alpha]"}], "]"}]}]}], 
          RowBox[{"2", " ", 
           RowBox[{"Gamma", "[", "\[Alpha]", "]"}]}]], 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["rt", "\[Rho]p"], ")"}], 
          RowBox[{"2", "\[Alpha]"}]]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "a", ",", "\[Rho]p", ",", "\[CapitalDelta]zNumeric", ",", 
         "\[CapitalDelta]zAnalytic1", ",", "\[CapitalDelta]zAnalytic2"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"random", " ", "test", " ", "case"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "xv", ",", "kv", ",", "x0", ",", "k0", ",", "s", ",", "t", ",", "vF", ",", 
   "\[Alpha]", ",", "\[Chi]", ",", "ti", ",", "tf"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x0", ",", "k0"}], "}"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3.5", "+", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", "0"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transverseShift", "[", 
   RowBox[{"x0", ",", "k0", ",", "1", ",", "1", ",", 
    RowBox[{"1", "/", "2"}], ",", "1", ",", 
    RowBox[{"-", "50000"}], ",", "50000"}], "]"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8763722583779593`*^9, 3.876372259431946*^9}, {
  3.87639095451457*^9, 3.876390956217579*^9}, {3.8763919439534407`*^9, 
  3.8763919459093246`*^9}, {3.876817012837165*^9, 3.876817137516218*^9}, {
  3.8768171686540194`*^9, 3.8768171871219597`*^9}},
 CellLabel->
  "In[403]:=",ExpressionUUID->"fe9c22e8-f27d-42e2-b49a-0961909f16b1"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Case Analysis (needs revision)", "Subsection",
 CellChangeTimes->{{3.876211684824133*^9, 3.876211687491818*^9}, {
  3.876216291171008*^9, 3.876216291828706*^9}, {3.876816885617985*^9, 
  3.876816888742969*^9}},ExpressionUUID->"86b1f668-e169-4b17-a61c-\
a53b2d76c76a"],

Cell[CellGroupData[{

Cell[TextData[{
 "Lensing, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "z"], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "2c3d6eaa-5979-4d6a-90ef-1930d9f99632"]
}], "Subsubsection",
 CellChangeTimes->{{3.876212773587398*^9, 3.876212777077264*^9}, {
  3.876212830776032*^9, 
  3.8762128357742043`*^9}},ExpressionUUID->"ddbfbf95-e699-4310-ac22-\
3ca21f7da378"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"xv", ",", "kv", ",", "x0", ",", "k0", ",", "t"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "k0"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3.5"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "obtain", " ", "solution", " ", "with", " ", "initial", " ", "conditions",
      " ", "x0"}], ",", " ", "k0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xv", "[", "s_", "]"}], ",", 
      RowBox[{"kv", "[", "s_", "]"}], ",", "tf"}], "}"}], "=", 
    RowBox[{"solveSEOM", "[", 
     RowBox[{"x0", ",", "k0", ",", 
      RowBox[{"vF", "=", "1"}], ",", 
      RowBox[{"\[Rho]t", "=", "1.2"}], ",", 
      RowBox[{"\[Alpha]", "=", "0.5"}], ",", 
      RowBox[{"\[Chi]", "=", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"ti", "=", "0"}], ",", 
      RowBox[{"tf", "=", "40"}], ",", "s"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"plot", " ", "the", " ", "solution"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makePlots", "[", 
   RowBox[{
   "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "xv", ",", "kv", ",", "ti",
     ",", "tf"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876202449607046*^9, 3.87620246460498*^9}, {
   3.8762025042416563`*^9, 3.8762025081708508`*^9}, {3.8762025478315353`*^9, 
   3.876202549523097*^9}, {3.876202734464232*^9, 3.876202749041786*^9}, {
   3.8762027854989653`*^9, 3.876202828917985*^9}, {3.8762029446456547`*^9, 
   3.87620295351633*^9}, {3.876202990878449*^9, 3.876202990962721*^9}, {
   3.876203098940886*^9, 3.876203158753994*^9}, {3.876209195144755*^9, 
   3.8762092252484627`*^9}, {3.8762092644491997`*^9, 
   3.8762093079588137`*^9}, {3.876209372194146*^9, 3.8762094492272663`*^9}, 
   3.876211207888198*^9, {3.876211581456253*^9, 3.876211581541545*^9}, {
   3.8762116996724987`*^9, 3.876211699784801*^9}, 3.876211757114768*^9, 
   3.876212057023203*^9, {3.8762122808459578`*^9, 3.8762123132928753`*^9}, {
   3.876212782704933*^9, 3.8762128068350887`*^9}, {3.876212839824224*^9, 
   3.876212931826804*^9}, {3.876212973997509*^9, 3.876212992936593*^9}, {
   3.8762130573551407`*^9, 3.8762130977154284`*^9}, {3.87621331494979*^9, 
   3.876213374062437*^9}, {3.8762134601379833`*^9, 3.8762134602508307`*^9}, {
   3.876214135350264*^9, 3.8762141565470552`*^9}, {3.8762160077046213`*^9, 
   3.8762160078519773`*^9}, {3.876216665273892*^9, 3.876216665559404*^9}, {
   3.876278431039276*^9, 3.87627844491685*^9}, {3.8762792000630083`*^9, 
   3.876279200212097*^9}, {3.876279294801033*^9, 3.876279301047196*^9}, {
   3.876279561623369*^9, 3.876279604254713*^9}, {3.8762801131120443`*^9, 
   3.876280129618326*^9}, {3.876280164523526*^9, 3.876280187106764*^9}, {
   3.876391831744526*^9, 3.87639184254498*^9}, {3.87681686341115*^9, 
   3.876816865383367*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"8ba5295b-26f2-4ec7-beaa-69609c75fdc1"],

Cell[BoxData[
 RowBox[{"xv", "[", "a", "]"}]], "Input",
 CellChangeTimes->{{3.876391563821281*^9, 3.876391564805935*^9}, {
  3.87639184741477*^9, 3.876391848030621*^9}, {3.876392152380583*^9, 
  3.876392152431662*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"eed48ea0-ba51-4d7b-a819-2ff09be0b262"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Lensing, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "z"], "\[NotEqual]", "0"}], TraditionalForm]],
  ExpressionUUID->"859b60b3-6239-4b54-b71a-e572ed33bca1"]
}], "Subsubsection",
 CellChangeTimes->{{3.876212773587398*^9, 3.876212777077264*^9}, {
  3.876212830776032*^9, 3.8762128357742043`*^9}, {3.876213556691161*^9, 
  3.876213564069309*^9}},ExpressionUUID->"e400a94b-50e9-4a76-9b3f-\
7b27548d0b58"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"xv", ",", "kv", ",", "x0", ",", "k0", ",", "t"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "k0"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "4"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "obtain", " ", "solution", " ", "with", " ", "initial", " ", "conditions",
      " ", "x0"}], ",", " ", "k0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xv", "[", "t_", "]"}], ",", 
     RowBox[{"kv", "[", "t_", "]"}], ",", "tf"}], "}"}], "=", 
   RowBox[{"solutionSEOMLinearized", "[", 
    RowBox[{"x0", ",", "k0", ",", 
     RowBox[{"vF", "=", "1"}], ",", 
     RowBox[{"\[Rho]t", "=", "1.2"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.5"}], ",", 
     RowBox[{"\[Chi]", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"ti", "=", "0"}], ",", 
     RowBox[{"tf", "=", "40"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"makePlots", "[", 
   RowBox[{
   "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "xv", ",", "kv", ",", "ti",
     ",", "tf"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876202449607046*^9, 3.87620246460498*^9}, {
   3.8762025042416563`*^9, 3.8762025081708508`*^9}, {3.8762025478315353`*^9, 
   3.876202549523097*^9}, {3.876202734464232*^9, 3.876202749041786*^9}, {
   3.8762027854989653`*^9, 3.876202828917985*^9}, {3.8762029446456547`*^9, 
   3.87620295351633*^9}, {3.876202990878449*^9, 3.876202990962721*^9}, {
   3.876203098940886*^9, 3.876203158753994*^9}, {3.876209195144755*^9, 
   3.8762092252484627`*^9}, {3.8762092644491997`*^9, 
   3.8762093079588137`*^9}, {3.876209372194146*^9, 3.8762094492272663`*^9}, 
   3.876211207888198*^9, {3.876211581456253*^9, 3.876211581541545*^9}, {
   3.8762116996724987`*^9, 3.876211699784801*^9}, 3.876211757114768*^9, 
   3.876212057023203*^9, {3.8762122808459578`*^9, 3.8762123132928753`*^9}, {
   3.876212782704933*^9, 3.8762128068350887`*^9}, {3.876212839824224*^9, 
   3.876212931826804*^9}, {3.876212973997509*^9, 3.876212992936593*^9}, {
   3.8762130573551407`*^9, 3.8762130977154284`*^9}, {3.87621331494979*^9, 
   3.876213374062437*^9}, {3.8762134601379833`*^9, 3.8762134602508307`*^9}, {
   3.876213568149726*^9, 3.87621356820411*^9}, {3.8762141060781384`*^9, 
   3.8762141134561453`*^9}, {3.8762141738660383`*^9, 
   3.8762141745719967`*^9}, {3.8762158004615927`*^9, 3.876215949410845*^9}, 
   3.876216001195833*^9, {3.876216665708499*^9, 3.876216666006266*^9}, 
   3.876279327591407*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"be4390f1-80cd-4645-8f77-51169d87dec9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Unstable Orbit", "Subsubsection",
 CellChangeTimes->{{3.876212773587398*^9, 3.876212777077264*^9}, {
  3.876212830776032*^9, 3.8762128357742043`*^9}, {3.876213556691161*^9, 
  3.876213564069309*^9}, {3.876213633129332*^9, 
  3.876213635962284*^9}},ExpressionUUID->"99db847d-8409-429b-a999-\
e56108e9aafa"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"xv", ",", "kv", ",", "x0", ",", "k0", ",", "t"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]", "=", 
   RowBox[{"+", "1"}]}], ";", 
  RowBox[{"\[Alpha]", "=", 
   RowBox[{"1", "/", "2"}]}], ";", 
  RowBox[{"\[Rho]t", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ky0", " ", "=", " ", 
   FractionBox["\[Alpha]", 
    RowBox[{"\[Alpha]", "+", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kx0", "=", 
   FractionBox["ky0", 
    SqrtBox["\[Alpha]"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "k0"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]s", "[", 
         RowBox[{"\[Rho]t", ",", "\[Alpha]"}], "]"}], ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx0", ",", "ky0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "obtain", " ", "solution", " ", "with", " ", "initial", " ", "conditions",
      " ", "x0"}], ",", " ", "k0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xv", "[", "t_", "]"}], ",", 
     RowBox[{"kv", "[", "t_", "]"}], ",", "tf"}], "}"}], "=", 
   RowBox[{"solutionSEOMLinearized", "[", 
    RowBox[{"x0", ",", "k0", ",", 
     RowBox[{"vF", "=", "1"}], ",", "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]",
      ",", 
     RowBox[{"ti", "=", "0"}], ",", 
     RowBox[{"tf", "=", "40"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"makePlots", "[", 
   RowBox[{
   "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "xv", ",", "kv", ",", "ti",
     ",", "tf"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876202449607046*^9, 3.87620246460498*^9}, {
   3.8762025042416563`*^9, 3.8762025081708508`*^9}, {3.8762025478315353`*^9, 
   3.876202549523097*^9}, {3.876202734464232*^9, 3.876202749041786*^9}, {
   3.8762027854989653`*^9, 3.876202828917985*^9}, {3.8762029446456547`*^9, 
   3.87620295351633*^9}, {3.876202990878449*^9, 3.876202990962721*^9}, {
   3.876203098940886*^9, 3.876203158753994*^9}, {3.876209195144755*^9, 
   3.8762092252484627`*^9}, {3.8762092644491997`*^9, 
   3.8762093079588137`*^9}, {3.876209372194146*^9, 3.8762094492272663`*^9}, 
   3.876211207888198*^9, {3.876211581456253*^9, 3.876211581541545*^9}, {
   3.8762116996724987`*^9, 3.876211699784801*^9}, 3.876211757114768*^9, 
   3.876212057023203*^9, {3.8762122808459578`*^9, 3.8762123132928753`*^9}, {
   3.876212782704933*^9, 3.8762128068350887`*^9}, {3.876212839824224*^9, 
   3.876212931826804*^9}, {3.876212973997509*^9, 3.876212992936593*^9}, {
   3.8762130573551407`*^9, 3.8762130977154284`*^9}, {3.87621331494979*^9, 
   3.876213374062437*^9}, {3.8762134601379833`*^9, 3.8762134602508307`*^9}, {
   3.876213568149726*^9, 3.87621356820411*^9}, {3.8762136622150793`*^9, 
   3.876213956159441*^9}, {3.876213997747775*^9, 3.876214017224112*^9}, {
   3.876214088042946*^9, 3.876214091217634*^9}, 3.8762141870554447`*^9, {
   3.876216100615735*^9, 3.8762161090399017`*^9}, {3.876216144689081*^9, 
   3.8762162024980297`*^9}, {3.8762166661576643`*^9, 3.876216667031542*^9}, 
   3.876279345942913*^9, {3.876296990525762*^9, 3.876296998638966*^9}, {
   3.876297052290653*^9, 3.876297053332765*^9}},
 CellLabel->
  "In[2343]:=",ExpressionUUID->"f86fa1e1-9ccf-4d85-b2c6-d98abf7c18f6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Capture", "Subsubsection",
 CellChangeTimes->{{3.876212773587398*^9, 3.876212777077264*^9}, {
  3.876212830776032*^9, 3.8762128357742043`*^9}, {3.876213556691161*^9, 
  3.876213564069309*^9}, {3.876213633129332*^9, 3.876213635962284*^9}, {
  3.876216310132303*^9, 
  3.876216311062275*^9}},ExpressionUUID->"70471d8d-9051-45ec-b1bf-\
98b5dbc06736"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"xv", ",", "kv", ",", "x0", ",", "k0", ",", "t"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]", "=", 
   RowBox[{"+", "1"}]}], ";", 
  RowBox[{"\[Alpha]", "=", 
   RowBox[{"1", "/", "2"}]}], ";", 
  RowBox[{"\[Rho]t", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ky0", " ", "=", " ", 
   FractionBox["\[Alpha]", 
    RowBox[{"\[Alpha]", "+", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kx0", "=", 
   FractionBox["ky0", 
    SqrtBox["\[Alpha]"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "k0"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.99", 
         RowBox[{"\[Rho]s", "[", 
          RowBox[{"\[Rho]t", ",", "\[Alpha]"}], "]"}]}], ",", "0", ",", "0"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx0", ",", "ky0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "obtain", " ", "solution", " ", "with", " ", "initial", " ", "conditions",
      " ", "x0"}], ",", " ", "k0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xv", "[", "t_", "]"}], ",", 
     RowBox[{"kv", "[", "t_", "]"}], ",", "tf"}], "}"}], "=", 
   RowBox[{"solutionSEOMLinearized", "[", 
    RowBox[{"x0", ",", "k0", ",", 
     RowBox[{"vF", "=", "1"}], ",", "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]",
      ",", 
     RowBox[{"ti", "=", "0"}], ",", 
     RowBox[{"tf", "=", "80"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"makePlots2D", "[", 
   RowBox[{
   "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "xv", ",", "kv", ",", "ti",
     ",", "tf"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876202449607046*^9, 3.87620246460498*^9}, {
   3.8762025042416563`*^9, 3.8762025081708508`*^9}, {3.8762025478315353`*^9, 
   3.876202549523097*^9}, {3.876202734464232*^9, 3.876202749041786*^9}, {
   3.8762027854989653`*^9, 3.876202828917985*^9}, {3.8762029446456547`*^9, 
   3.87620295351633*^9}, {3.876202990878449*^9, 3.876202990962721*^9}, {
   3.876203098940886*^9, 3.876203158753994*^9}, {3.876209195144755*^9, 
   3.8762092252484627`*^9}, {3.8762092644491997`*^9, 
   3.8762093079588137`*^9}, {3.876209372194146*^9, 3.8762094492272663`*^9}, 
   3.876211207888198*^9, {3.876211581456253*^9, 3.876211581541545*^9}, {
   3.8762116996724987`*^9, 3.876211699784801*^9}, 3.876211757114768*^9, 
   3.876212057023203*^9, {3.8762122808459578`*^9, 3.8762123132928753`*^9}, {
   3.876212782704933*^9, 3.8762128068350887`*^9}, {3.876212839824224*^9, 
   3.876212931826804*^9}, {3.876212973997509*^9, 3.876212992936593*^9}, {
   3.8762130573551407`*^9, 3.8762130977154284`*^9}, {3.87621331494979*^9, 
   3.876213374062437*^9}, {3.8762134601379833`*^9, 3.8762134602508307`*^9}, {
   3.876213568149726*^9, 3.87621356820411*^9}, {3.8762136622150793`*^9, 
   3.876213956159441*^9}, {3.876213997747775*^9, 3.876214017224112*^9}, {
   3.876214088042946*^9, 3.876214091217634*^9}, 3.8762141870554447`*^9, {
   3.876216100615735*^9, 3.8762161090399017`*^9}, {3.876216144689081*^9, 
   3.8762162024980297`*^9}, {3.876216320204741*^9, 3.876216343544739*^9}, {
   3.876216374749035*^9, 3.8762164285500813`*^9}, {3.876216667163705*^9, 
   3.8762166682316103`*^9}, {3.876217907399022*^9, 3.876217914087459*^9}, 
   3.8762793760226793`*^9, {3.876297077221315*^9, 3.8762971034602947`*^9}},
 CellLabel->
  "In[2357]:=",ExpressionUUID->"f61fd84f-76b3-4026-a36f-2db6bd32ce3e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Escape is equivalent to time-reversed capture", "Subsubsection",
 CellChangeTimes->{{3.876212773587398*^9, 3.876212777077264*^9}, {
  3.876212830776032*^9, 3.8762128357742043`*^9}, {3.876213556691161*^9, 
  3.876213564069309*^9}, {3.876213633129332*^9, 3.876213635962284*^9}, {
  3.876216310132303*^9, 3.876216311062275*^9}, {3.876216447585541*^9, 
  3.876216448207098*^9}, {3.876217785431851*^9, 3.8762177969818363`*^9}, {
  3.8762783500543118`*^9, 3.876278370506028*^9}, {3.876280536775936*^9, 
  3.8762805766926126`*^9}},ExpressionUUID->"977ef9f1-d520-447a-aea5-\
6b4db1dd0f7f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"xv", ",", "kv", ",", "x0", ",", "k0", ",", "t"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]", "=", 
   RowBox[{"+", "1"}]}], ";", 
  RowBox[{"\[Alpha]", "=", 
   RowBox[{"1", "/", "2"}]}], ";", 
  RowBox[{"\[Rho]t", "=", "1"}], ";", 
  RowBox[{"\[Phi]", "=", 
   RowBox[{"0.04", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "k0"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1.1", "*", "\[Rho]t", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "obtain", " ", "solution", " ", "with", " ", "initial", " ", "conditions",
      " ", "x0"}], ",", " ", "k0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xv", "[", "t_", "]"}], ",", 
     RowBox[{"kv", "[", "t_", "]"}], ",", "tf"}], "}"}], "=", 
   RowBox[{"solutionSEOMLinearized", "[", 
    RowBox[{"x0", ",", "k0", ",", 
     RowBox[{"vF", "=", "1"}], ",", "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]",
      ",", 
     RowBox[{"ti", "=", 
      RowBox[{"-", "10"}]}], ",", 
     RowBox[{"tf", "=", "10"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"makePlots2D", "[", 
   RowBox[{
   "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "xv", ",", "kv", ",", "ti",
     ",", "tf", ",", "1", ",", "2"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.876202449607046*^9, 3.87620246460498*^9}, {
   3.8762025042416563`*^9, 3.8762025081708508`*^9}, {3.8762025478315353`*^9, 
   3.876202549523097*^9}, {3.876202734464232*^9, 3.876202749041786*^9}, {
   3.8762027854989653`*^9, 3.876202828917985*^9}, {3.8762029446456547`*^9, 
   3.87620295351633*^9}, {3.876202990878449*^9, 3.876202990962721*^9}, {
   3.876203098940886*^9, 3.876203158753994*^9}, {3.876209195144755*^9, 
   3.8762092252484627`*^9}, {3.8762092644491997`*^9, 
   3.8762093079588137`*^9}, {3.876209372194146*^9, 3.8762094492272663`*^9}, 
   3.876211207888198*^9, {3.876211581456253*^9, 3.876211581541545*^9}, {
   3.8762116996724987`*^9, 3.876211699784801*^9}, 3.876211757114768*^9, 
   3.876212057023203*^9, {3.8762122808459578`*^9, 3.8762123132928753`*^9}, {
   3.876212782704933*^9, 3.8762128068350887`*^9}, {3.876212839824224*^9, 
   3.876212931826804*^9}, {3.876212973997509*^9, 3.876212992936593*^9}, {
   3.8762130573551407`*^9, 3.8762130977154284`*^9}, {3.87621331494979*^9, 
   3.876213374062437*^9}, {3.8762134601379833`*^9, 3.8762134602508307`*^9}, {
   3.876213568149726*^9, 3.87621356820411*^9}, {3.8762136622150793`*^9, 
   3.876213956159441*^9}, {3.876213997747775*^9, 3.876214017224112*^9}, {
   3.876214088042946*^9, 3.876214091217634*^9}, 3.8762141870554447`*^9, {
   3.876216100615735*^9, 3.8762161090399017`*^9}, {3.876216144689081*^9, 
   3.8762162024980297`*^9}, {3.876216320204741*^9, 3.876216343544739*^9}, {
   3.876216374749035*^9, 3.876216618238616*^9}, {3.8762166593744087`*^9, 
   3.876216664535137*^9}, {3.876216717472364*^9, 3.876216717620852*^9}, {
   3.876216771022394*^9, 3.876216863911769*^9}, {3.8762169545257874`*^9, 
   3.876217124344407*^9}, {3.876217822263674*^9, 3.876217825933062*^9}, {
   3.876217920769182*^9, 3.8762179255382347`*^9}, {3.8762179951011887`*^9, 
   3.8762180055927467`*^9}, {3.876218064160915*^9, 3.876218064304489*^9}, {
   3.876280230657832*^9, 3.8762802443531923`*^9}, 3.876280296350031*^9},
 CellLabel->
  "In[2364]:=",ExpressionUUID->"4be2b3d6-6039-4c41-8c75-bea2e0b1ef46"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"xv", ",", "kv", ",", "x0", ",", "k0", ",", "t"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]", "=", 
   RowBox[{"+", "1"}]}], ";", 
  RowBox[{"\[Alpha]", "=", 
   RowBox[{"1", "/", "2"}]}], ";", 
  RowBox[{"\[Rho]t", "=", "1"}], ";", 
  RowBox[{"\[Phi]", "=", 
   RowBox[{"0.04", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "k0"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1.1", "*", "\[Rho]t", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "obtain", " ", "solution", " ", "with", " ", "initial", " ", "conditions",
      " ", "x0"}], ",", " ", "k0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xv", "[", "t_", "]"}], ",", 
     RowBox[{"kv", "[", "t_", "]"}], ",", "tf"}], "}"}], "=", 
   RowBox[{"solutionSEOMLinearizedTR", "[", 
    RowBox[{"x0", ",", "k0", ",", 
     RowBox[{"vF", "=", "1"}], ",", "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]",
      ",", 
     RowBox[{"ti", "=", 
      RowBox[{"-", "tf"}]}], ",", 
     RowBox[{"tf", "=", 
      RowBox[{"-", "ti"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"makePlots2D", "[", 
   RowBox[{
   "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "xv", ",", "kv", ",", "ti",
     ",", "tf", ",", "1", ",", "2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876202449607046*^9, 3.87620246460498*^9}, {
   3.8762025042416563`*^9, 3.8762025081708508`*^9}, {3.8762025478315353`*^9, 
   3.876202549523097*^9}, {3.876202734464232*^9, 3.876202749041786*^9}, {
   3.8762027854989653`*^9, 3.876202828917985*^9}, {3.8762029446456547`*^9, 
   3.87620295351633*^9}, {3.876202990878449*^9, 3.876202990962721*^9}, {
   3.876203098940886*^9, 3.876203158753994*^9}, {3.876209195144755*^9, 
   3.8762092252484627`*^9}, {3.8762092644491997`*^9, 
   3.8762093079588137`*^9}, {3.876209372194146*^9, 3.8762094492272663`*^9}, 
   3.876211207888198*^9, {3.876211581456253*^9, 3.876211581541545*^9}, {
   3.8762116996724987`*^9, 3.876211699784801*^9}, 3.876211757114768*^9, 
   3.876212057023203*^9, {3.8762122808459578`*^9, 3.8762123132928753`*^9}, {
   3.876212782704933*^9, 3.8762128068350887`*^9}, {3.876212839824224*^9, 
   3.876212931826804*^9}, {3.876212973997509*^9, 3.876212992936593*^9}, {
   3.8762130573551407`*^9, 3.8762130977154284`*^9}, {3.87621331494979*^9, 
   3.876213374062437*^9}, {3.8762134601379833`*^9, 3.8762134602508307`*^9}, {
   3.876213568149726*^9, 3.87621356820411*^9}, {3.8762136622150793`*^9, 
   3.876213956159441*^9}, {3.876213997747775*^9, 3.876214017224112*^9}, {
   3.876214088042946*^9, 3.876214091217634*^9}, 3.8762141870554447`*^9, {
   3.876216100615735*^9, 3.8762161090399017`*^9}, {3.876216144689081*^9, 
   3.8762162024980297`*^9}, {3.876216320204741*^9, 3.876216343544739*^9}, {
   3.876216374749035*^9, 3.876216618238616*^9}, {3.8762166593744087`*^9, 
   3.876216664535137*^9}, {3.876216717472364*^9, 3.876216717620852*^9}, {
   3.876216771022394*^9, 3.876216863911769*^9}, {3.8762169545257874`*^9, 
   3.876217124344407*^9}, {3.876217188664172*^9, 3.876217250422168*^9}, {
   3.8762173815724373`*^9, 3.876217488551971*^9}, {3.8762175469656143`*^9, 
   3.8762175494950247`*^9}, {3.876217816699093*^9, 3.876217816840912*^9}, {
   3.876217949627685*^9, 3.8762179500552063`*^9}, {3.876218023286201*^9, 
   3.876218028526966*^9}, {3.876280261602324*^9, 3.876280288900853*^9}},
 CellLabel->
  "In[2369]:=",ExpressionUUID->"1dd9376b-1516-4239-8a71-b24e840df1cb"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerics vs. Analytic Approximations", "Subsection",
 CellChangeTimes->{{3.876211684824133*^9, 3.876211687491818*^9}, {
  3.876216291171008*^9, 3.876216291828706*^9}, {3.8762804894930477`*^9, 
  3.876280500308955*^9}},ExpressionUUID->"471f9e0e-9fd6-41aa-88e7-\
07f9cf41fd74"],

Cell[CellGroupData[{

Cell["Lensing Angle", "Subsubsection",
 CellChangeTimes->{{3.876283915669186*^9, 
  3.876283919313569*^9}},ExpressionUUID->"4241d1b9-6af5-44b4-8bca-\
4bf29d0c6b6e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "xv", ",", "kv", ",", "x0", ",", "k0", ",", "x0k0s", ",", "t", ",", 
    "\[Rho]t", ",", "vF", ",", "xs", ",", "\[Alpha]", ",", "\[Chi]", ",", 
    "nti", ",", "ntf"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]s", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", "1", ",", 
     RowBox[{"3", "/", "2"}], ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]t", "=", "1"}], ";", 
  RowBox[{"vF", "=", "1"}], ";", 
  RowBox[{"\[Chi]", "=", 
   RowBox[{"+", "1"}]}], ";", 
  RowBox[{"nti", "=", 
   RowBox[{"-", "1000"}]}], ";", 
  RowBox[{"ntf", "=", 
   RowBox[{"-", "nti"}]}], ";", 
  RowBox[{"\[Rho]s", "[", 
   RowBox[{"\[Rho]t", ",", "\[Alpha]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], "*", 
      SuperscriptBox["10", "x"]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "2", ",", "0.025"}], "}"}]}], "]"}]}], ";", 
  
  RowBox[{"x0k0s", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{
        FractionBox["1", 
         SqrtBox["2"]], 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "&"}], "/@", 
    "xs"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876284665864373*^9, 3.876284694799404*^9}, {
   3.876284775866069*^9, 3.876284779855748*^9}, {3.876286858362134*^9, 
   3.876286872508885*^9}, {3.876286936534634*^9, 3.876286941167001*^9}, {
   3.876286979736411*^9, 3.876286981688355*^9}, {3.876288202080182*^9, 
   3.87628837772644*^9}, {3.876288486741686*^9, 3.87628854570193*^9}, {
   3.876288764702566*^9, 3.8762888064345217`*^9}, {3.8762897487231417`*^9, 
   3.87628978931619*^9}, {3.876290001850498*^9, 3.876290029483636*^9}, {
   3.8762901021153708`*^9, 3.87629011929996*^9}, {3.876290183202178*^9, 
   3.876290269508654*^9}, {3.876290305600251*^9, 3.876290306524467*^9}, {
   3.876291975745947*^9, 3.876292126773094*^9}, {3.876292244626021*^9, 
   3.87629224532025*^9}, {3.876292399021867*^9, 3.876292470284574*^9}, {
   3.876293262385076*^9, 3.876293265103135*^9}, {3.8762933102603817`*^9, 
   3.8762935585424767`*^9}, {3.876296322589383*^9, 3.876296440543792*^9}, {
   3.876296487027658*^9, 3.8762969468620777`*^9}, {3.87629713735493*^9, 
   3.876297390057485*^9}, {3.8762974410866127`*^9, 3.876297468192031*^9}, {
   3.876297500573731*^9, 3.876297631604609*^9}, {3.87629771640373*^9, 
   3.87629787693121*^9}, {3.876297912235538*^9, 3.8762979162186193`*^9}, {
   3.876298122811596*^9, 3.876298184485957*^9}, {3.876298446574203*^9, 
   3.8762984480491037`*^9}, {3.876298521763873*^9, 3.87629854173988*^9}, {
   3.87629859355158*^9, 3.87629862158324*^9}, {3.8762986645636063`*^9, 
   3.876298685803686*^9}, {3.8762987162478952`*^9, 3.876298838716179*^9}, {
   3.876299035675013*^9, 3.8762990360931463`*^9}, {3.87636890152318*^9, 
   3.87636891486348*^9}, {3.876369047748521*^9, 3.876369052362012*^9}, {
   3.87637059367612*^9, 3.876370593900783*^9}, {3.876371481504348*^9, 
   3.8763715087408667`*^9}, {3.8763719016074266`*^9, 3.876371901992743*^9}, {
   3.876372005853339*^9, 3.876372024151091*^9}, 3.876386553482665*^9, {
   3.876816906107141*^9, 3.8768169157818203`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"d47f2d2d-d412-4165-a857-008bf648df85"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allLensingAngles", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"lensingAngles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"lensingAngle", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "vF", ",", "\[Rho]t", ",", 
           "\[Alpha]", ",", "\[Chi]", ",", "nti", ",", "ntf"}], "]"}], "&"}], 
        "/@", "x0k0s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"allLensingAngles", ",", "lensingAngles"}], "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Alpha]s"}], "}"}]}], "]"}], ",", 
   "\[Alpha]"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxV1IU2EABuCtBG1EqXQTwsTN6KIMf3KLHTXdhUhK5BHJOIpg5FU15/xJ
RAmlWUxDlp7poEQhUUGbjTmnzCh1TFhgCtNN0Tm3JB0zFJ04sb73XDw8CRUK
+tkFHo93k8AHQ1T8i61AzmSXS4SdE+Hb+EFFYxLWs/kpL8kLedFp2BIXQ+HY
ks/cY5312ZgfOcHt7pS78L8s6T72Ta+cYUmdJEJBft7IxmP9zs9EfCrW6bFM
ONKH86TUFD5o+GLFwvFZG87t/WPHWa9+L2J/rmENy9PTPFhhf8Tt2AgZqsjJ
1tVZXBbVtYSb7o9wi4weP6biFoJYQzsKlWRvgZjGl4vtj/EJ86sOy9bpxWry
TGXMJv7g9fhwIssIVWSWuSXBe87vxfjtvKgUC2+oyzG/VPsUH5UcqjCz196M
GxwftbjtXaQOB8/V3D0nT8bxcftVC94sX3JhuZbvxoPKe9v4+qjZjzWDKQG8
M/x1H0dfij3CDrMlhH8E28L4765TUEM29daK8ZVwC7fPashmyf39jBx7D0M0
1ndrirBtIP2ajixdzuD+JE5uxXdMOjUWVBnNuGPuG/f7h9Nz+O6bURuWpQou
Kr2BnMzXVBT+D4RDaiA=
  "],
 CellLabel->
  "In[234]:=",ExpressionUUID->"8af3d2f2-481f-4b92-87fc-911d38acc3fe"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"allLensingAngles", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", ";;", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"allLensingAngles", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", ";;", ",", "s"}], "]"}], "]"}]}], "}"}], 
          "\[Transpose]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "6"}]], ",", "\[Pi]"}], "}"}]}], "}"}]}], ",", " ", 
       
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Opacity", "[", 
         RowBox[{"1", "/", "a"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"MaTeX", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\\\\text{periapsis }\\\\rho_p/\\\\rho_t\>\"", ",", 
       "\"\<\\\\text{Lensing angle }\\\\varphi\>\""}], "}"}], "]"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87629788303553*^9, 3.876297900689047*^9}, {
  3.876297931928604*^9, 3.8762979934385433`*^9}, {3.876298196309402*^9, 
  3.87629822729698*^9}, {3.876298257482386*^9, 3.876298351437479*^9}, {
  3.876298856387048*^9, 3.876298917843349*^9}, {3.876298968379734*^9, 
  3.8762989857284184`*^9}, {3.8762991176309633`*^9, 3.8762991186630583`*^9}, {
  3.876299154792714*^9, 3.8762991708282547`*^9}, {3.876299221629558*^9, 
  3.87629925054633*^9}, {3.876300987695215*^9, 3.876300991395934*^9}, {
  3.876368764860949*^9, 3.8763687649699574`*^9}, {3.876372480508017*^9, 
  3.876372488696578*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"0583762d-6a2c-4743-829f-49831259bc0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "to", " ", "evaluate", " ", "this", " ", "commented", " ", "cell", " ", 
     "takes", " ", "quite", " ", "some", " ", "time"}], ",", " ", 
    RowBox[{"with", " ", "the", " ", "result", " ", 
     FractionBox[
      RowBox[{
       SqrtBox["\[Pi]"], " ", 
       RowBox[{"Gamma", "[", 
        RowBox[{"-", "\[Alpha]"}], "]"}], " ", 
       RowBox[{"Tan", "[", 
        RowBox[{"\[Pi]", " ", "\[Alpha]"}], "]"}]}], 
      RowBox[{"Gamma", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], "-", "\[Alpha]"}], "]"}]]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Rho]p", ",", "\[Alpha]"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "-", 
          RowBox[{
           SuperscriptBox["\[Rho]p", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["\[Rho]p", "\[Rho]"], ")"}], 
            RowBox[{"2", "\[Alpha]"}]]}]}], ")"}], 
        RowBox[{
         SuperscriptBox["\[Rho]", "2"], "-", 
         SuperscriptBox["\[Rho]p", "2"]}]], 
       FractionBox["\[Rho]p", 
        RowBox[{"\[Rho]", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], "-", 
           SuperscriptBox["\[Rho]p", "2"]}]]}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", "\[Rho]p", ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{
        RowBox[{"\[Rho]p", ">", "0"}], "&&", 
        RowBox[{"\[Alpha]", ">", "0"}]}]}]}], "]"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.87629034999949*^9, 3.876290373915039*^9}, {
  3.876290416313857*^9, 3.8762904448230257`*^9}, {3.876290500407507*^9, 
  3.876290500685296*^9}, {3.876290675808053*^9, 3.876290682265316*^9}, {
  3.8762913576913033`*^9, 3.876291378440007*^9}, {3.876291809537841*^9, 
  3.87629182992775*^9}, {3.8762923382274647`*^9, 
  3.876292368807871*^9}},ExpressionUUID->"96cd8e0f-a2b3-4cd7-a909-\
e1ef93fabc14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["\[Pi]"], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{"-", "\[Alpha]"}], "]"}], " ", 
         RowBox[{"Tan", "[", 
          RowBox[{"\[Pi]", " ", "\[Alpha]"}], "]"}]}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "2"], "+", "\[Alpha]"}], ")"}]}], "]"}]], ",", 
       RowBox[{"\[Alpha]", "\[Rule]", "#"}]}], "]"}], "&"}], "/@", 
    "\[Alpha]s"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SqrtBox["\[Pi]"], " ", 
     RowBox[{"Gamma", "[", 
      RowBox[{"-", "\[Alpha]"}], "]"}], " ", 
     RowBox[{"Tan", "[", 
      RowBox[{"\[Pi]", " ", "\[Alpha]"}], "]"}]}], 
    RowBox[{"Gamma", "[", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", "\[Alpha]"}], ")"}]}], "]"}]], ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", 
     RowBox[{"-", "1"}], ",", "5"}], "}"}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]s", ",", "pf"}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"MaTeX", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\\\\alpha\>\"", ",", 
       "\"\<\\\\sqrt\\\\pi\\\\frac{\\\\Gamma(-\\\\alpha)\\\\tan(\\\\pi\\\\\
alpha)}{\\\\Gamma(-(\\\\alpha+1/2))}\>\""}], "}"}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8762915233604393`*^9, 3.876291749738435*^9}, {
  3.8762917909263372`*^9, 3.876291803186165*^9}, {3.8762918937638206`*^9, 
  3.8762919419345703`*^9}, {3.876370584704348*^9, 3.876370585036272*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"25d2edc8-bba5-46cd-b9c0-42e2ba3ad368"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Alpha]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     SqrtBox["\[Pi]"], " ", 
     RowBox[{"Gamma", "[", 
      RowBox[{"-", "\[Alpha]"}], "]"}], " ", 
     RowBox[{"Tan", "[", 
      RowBox[{"\[Pi]", " ", "\[Alpha]"}], "]"}]}], 
    RowBox[{"Gamma", "[", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", "\[Alpha]"}], ")"}]}], "]"}]], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"-", "\[Alpha]"}], "]"}], "\[Rule]", " ", 
      FractionBox[
       RowBox[{"\[Pi]", " ", 
        RowBox[{"Csc", "[", 
         RowBox[{"\[Pi]", " ", "\[Alpha]"}], "]"}]}], 
       RowBox[{"\[Alpha]", " ", 
        RowBox[{"Gamma", "[", "\[Alpha]", "]"}]}]]}], ",", 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[Alpha]"}], ")"}]}], "]"}], "\[Rule]",
       "  ", 
      FractionBox[
       RowBox[{"\[Pi]", " ", 
        RowBox[{"Csc", "[", 
         RowBox[{"\[Pi]", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "2"], "+", "\[Alpha]"}], ")"}]}], "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "2"], "+", "\[Alpha]"}], ")"}], "]"}]}]]}]}], 
    "}"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.876395306436286*^9, 3.876395365540379*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"b57f2315-6a47-4e3b-ae1f-9a8347fb422c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"export", " ", "data", " ", "to", " ", "CSV", " ", "file"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dims", "=", 
     RowBox[{"allLensingAngles", "//", "Dimensions"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"allLensingAnglesMat", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"allLensingAngles", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"dims", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"dims", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Alpha]Column", " ", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"\[Alpha]s", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "*", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "\[Alpha]s", "]"}]}], "}"}]}], "]"}], 
        "]"}], "}"}], "\[Transpose]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"data", "=", "allLensingAnglesMat"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"\[Alpha]Column", ",", "data", ",", "2"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\\\\alpha\>\"", ",", "\"\<\\\\rho_p/\\\\rho_t\>\"", ",", 
       "\"\<\\\\varphi from trajectories\>\"", ",", 
       "\"\<\\\\varphi numerical integration\>\"", ",", 
       "\"\<\\\\varphi approx.\>\""}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"data", ",", "header"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"pathOut", "=", 
     RowBox[{"SetDirectory", "[", 
      RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"pathOut", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\</lensing_angle_chi_`1`_rhot_`2`_vF_`3`.csv\>\"", ",", "\[Chi]", 
         ",", "\[Rho]t", ",", "vF"}], "]"}], "]"}]}], ",", "data"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.876369330981982*^9, 3.8763694305095463`*^9}, {
   3.87636993809477*^9, 3.876369953596612*^9}, {3.876370495328301*^9, 
   3.876370556687056*^9}, {3.8763719469979897`*^9, 3.876371986683949*^9}, 
   3.876372063949712*^9, {3.876372117792478*^9, 3.876372120152749*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"7d178f7e-6901-4b9d-a916-d71c597080ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transverse Shift", "Subsubsection",
 CellChangeTimes->{{3.876283915669186*^9, 3.876283919313569*^9}, {
  3.87629927162817*^9, 
  3.8762992741305943`*^9}},ExpressionUUID->"7342a176-fb88-4a7e-aa53-\
ccd7ffc4c5c0"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "x0", ",", "k0", ",", "vF", ",", "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", 
   ",", "ti", ",", "tf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]s", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", "1", ",", 
     RowBox[{"3", "/", "2"}], ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]", "=", 
   RowBox[{"+", "1"}]}], ";", 
  RowBox[{"\[Rho]t", "=", "1"}], ";", 
  RowBox[{"vF", "=", "1"}], ";", 
  RowBox[{"ti", "=", 
   RowBox[{"-", "10000"}]}], ";", 
  RowBox[{"tf", "=", 
   RowBox[{"-", "ti"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xs", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], "*", 
       SuperscriptBox["10", "x"]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "2", ",", "0.025"}], "}"}]}], "]"}]}], ";", 
   RowBox[{"x0k0s", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{
         FractionBox["1", 
          SqrtBox["2"]], 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "&"}], "/@", 
     "xs"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "loop", " ", "takes", " ", "about", " ", "5", " ", "minutes",
      " ", "on", " ", "my", " ", "laptop"}], "..."}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allTransverseShifts", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"transverseShifts", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"transverseShift", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "vF", ",", "\[Rho]t", ",", 
           "\[Alpha]", ",", "\[Chi]", ",", "ti", ",", "tf"}], "]"}], "&"}], "/@",
         "x0k0s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"allTransverseShifts", ",", "transverseShifts"}], "]"}], ";"}],
      "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Alpha]s"}], "}"}]}], "]"}], ",", 
   "\[Alpha]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.876299484826909*^9, 3.876299677070499*^9}, {
  3.876299708416728*^9, 3.876299814481843*^9}, {3.876299928394212*^9, 
  3.87630023486406*^9}, {3.876300286371763*^9, 3.876300455224091*^9}, {
  3.876300497651495*^9, 3.876300599018816*^9}, {3.876300633524918*^9, 
  3.876300651838739*^9}, {3.8763007289183273`*^9, 3.876300775961022*^9}, {
  3.876301312797521*^9, 3.8763015146202593`*^9}, {3.876302354665354*^9, 
  3.8763023689243517`*^9}, {3.876302471854248*^9, 3.876302507979559*^9}, {
  3.876368925039076*^9, 3.876368925714225*^9}, {3.876371913175323*^9, 
  3.87637192597616*^9}, {3.876372327692477*^9, 3.876372338532997*^9}, {
  3.87638608260809*^9, 3.876386103933674*^9}, {3.876816992469672*^9, 
  3.8768169931671543`*^9}},
 CellLabel->
  "In[408]:=",ExpressionUUID->"0870effe-ba71-4e8d-a338-a94599cb3c53"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"allTransverseShifts", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", ";;", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"allTransverseShifts", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", ";;", ",", "s"}], "]"}], "]"}]}], "}"}], 
          "\[Transpose]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "6"}]], ",", "\[Pi]"}], "}"}]}], "}"}]}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"Length", "[", "\[Alpha]s", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"MaTeX", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\\\\text{periapsis }\\\\rho_p/\\\\rho_t\>\"", ",", 
       "\"\<\\\\text{Transverse shift }\\\\Delta z\>\""}], "}"}], "]"}]}], 
   ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87629788303553*^9, 3.876297900689047*^9}, {
  3.876297931928604*^9, 3.8762979934385433`*^9}, {3.876298196309402*^9, 
  3.87629822729698*^9}, {3.876298257482386*^9, 3.876298351437479*^9}, {
  3.876298856387048*^9, 3.876298917843349*^9}, {3.876298968379734*^9, 
  3.8762989857284184`*^9}, {3.8762991176309633`*^9, 3.8762991186630583`*^9}, {
  3.876299154792714*^9, 3.8762991708282547`*^9}, {3.876299221629558*^9, 
  3.87629925054633*^9}, {3.876300987695215*^9, 3.876300991395934*^9}, {
  3.876302536703335*^9, 3.876302544882305*^9}, {3.8763025763005533`*^9, 
  3.876302609986615*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"5d7730f4-65a9-493b-aa98-8da6183930da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]s", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", "1", ",", 
     RowBox[{"3", "/", "2"}], ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]", "=", 
   RowBox[{"+", "1"}]}], ";", 
  RowBox[{"\[Rho]t", "=", "1"}], ";", 
  RowBox[{"vF", "=", "1"}], ";", 
  RowBox[{"ti", "=", 
   RowBox[{"-", "10000"}]}], ";", 
  RowBox[{"tf", "=", 
   RowBox[{"-", "ti"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], "*", 
      SuperscriptBox["10", "x"]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"x0k0s", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{
        FractionBox["1", 
         SqrtBox["2"]], 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "&"}], "/@", 
    "xs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transverseShifts", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"transverseShift", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "vF", ",", "\[Rho]t", ",", 
       RowBox[{"\[Alpha]s", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[Chi]", ",", "ti", ",", "tf"}],
       "]"}], "&"}], "/@", "x0k0s"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876391003623947*^9, 3.876391003917212*^9}, {
  3.876817272473518*^9, 3.876817273553337*^9}},
 CellLabel->
  "In[419]:=",ExpressionUUID->"a85c11fc-8b0a-4442-a071-07dc02d72d9a"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"allTransverseShifts", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", ";;", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"allTransverseShifts", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", ";;", ",", "s"}], "]"}], "]"}]}], "}"}], 
          "\[Transpose]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "6"}]], ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "6"}]], ",", "\[Pi]"}], "}"}]}], "}"}]}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"Length", "[", "\[Alpha]s", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"MaTeX", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<a\>\"", ",", "\"\<\\\\text{Transverse shift }\\\\Delta z\>\""}], 
      "}"}], "]"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87629788303553*^9, 3.876297900689047*^9}, {
   3.876297931928604*^9, 3.8762979934385433`*^9}, {3.876298196309402*^9, 
   3.87629822729698*^9}, {3.876298257482386*^9, 3.876298351437479*^9}, {
   3.876298856387048*^9, 3.876298917843349*^9}, {3.876298968379734*^9, 
   3.8762989857284184`*^9}, {3.8762991176309633`*^9, 
   3.8762991186630583`*^9}, {3.876299154792714*^9, 3.8762991708282547`*^9}, {
   3.876299221629558*^9, 3.87629925054633*^9}, {3.876300987695215*^9, 
   3.876300991395934*^9}, {3.876302536703335*^9, 3.876302544882305*^9}, {
   3.8763025763005533`*^9, 3.876302655999*^9}, 3.8763909975971937`*^9},
 CellLabel->
  "In[423]:=",ExpressionUUID->"70ecd69f-ad24-4f6d-bc8e-da9914222290"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"export", " ", "data", " ", "to", " ", "CSV", " ", "file"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dims", "=", 
     RowBox[{"allTransverseShifts", "//", "Dimensions"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"allTransverseShiftsMat", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"allTransverseShifts", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"dims", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"dims", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Alpha]Column", " ", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"\[Alpha]s", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "*", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "\[Alpha]s", "]"}]}], "}"}]}], "]"}], 
        "]"}], "}"}], "\[Transpose]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"data", "=", "allTransverseShiftsMat"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"\[Alpha]Column", ",", "data", ",", "2"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\\\\alpha\>\"", ",", " ", "\"\<a\>\"", ",", 
       "\"\<\\\\rho_p/\\\\rho_t\>\"", ",", 
       "\"\<\\\\Delta z from trajectories\>\"", ",", 
       "\"\<\\\\Delta z numerical integration\>\"", ",", 
       "\"\<\\\\Delta z approx.\>\""}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"data", ",", "header"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"pathOut", "=", 
     RowBox[{"SetDirectory", "[", 
      RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"pathOut", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\</transverse_shift_chi_`1`_rhot_`2`_vF_`3`.csv\>\"", ",", 
         "\[Chi]", ",", "\[Rho]t", ",", "vF"}], "]"}], "]"}]}], ",", "data"}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.876369330981982*^9, 3.8763694305095463`*^9}, {
   3.87636993809477*^9, 3.876369953596612*^9}, {3.876370495328301*^9, 
   3.876370556687056*^9}, {3.8763719469979897`*^9, 3.876371986683949*^9}, 
   3.876372063949712*^9, {3.876372117792478*^9, 3.876372120152749*^9}, {
   3.8763723819586287`*^9, 3.876372448918305*^9}, {3.876372942269519*^9, 
   3.8763729801447783`*^9}, {3.87638029777945*^9, 3.8763802988619432`*^9}, 
   3.876380405400898*^9},
 CellLabel->
  "In[425]:=",ExpressionUUID->"2f506285-d9ef-4390-a2ff-000ce71b54d0"],

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", ";;"}], ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", ";;"}], ",", "2"}], "]"}], "]"}]}], "}"}], 
    "\[Transpose]"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"MaTeX", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<\\\\rho_p/\\\\rho_t\>\"", ",", "\"\<a\>\""}], "}"}], 
     "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87637303299124*^9, 3.876373109864373*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"efcc4684-5dac-4301-a601-8953e0d205e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListLogLogPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", ";;"}], ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", ";;"}], ",", "4"}], "]"}], "]"}]}], "}"}], 
     "\[Transpose]"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"MaTeX", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<\\\\rho_p/\\\\rho_t\>\"", ",", "\"\<\\\\Delta z\>\""}], 
       "}"}], "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"%", ",", 
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"2", ";;"}], ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"2", ";;"}], ",", "6"}], "]"}], "]"}]}], "}"}], 
      "\[Transpose]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"MaTeX", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<\\\\rho_p/\\\\rho_t\>\"", ",", "\"\<\\\\Delta z\>\""}], 
        "}"}], "]"}]}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.87637315484531*^9, 3.876373225120162*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"9d970bf1-1d08-4035-aa7e-4ea10000a43b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListLogLogPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", ";;"}], ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", ";;"}], ",", "4"}], "]"}], "]"}]}], "}"}], 
     "\[Transpose]"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"MaTeX", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<a\>\"", ",", "\"\<\\\\Delta z\>\""}], "}"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"%", ",", 
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"2", ";;"}], ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"2", ";;"}], ",", "6"}], "]"}], "]"}]}], "}"}], 
      "\[Transpose]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"MaTeX", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<a\>\"", ",", "\"\<\\\\Delta z\>\""}], "}"}], "]"}]}]}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.87637315484531*^9, 3.876373225120162*^9}, {
  3.876373273380789*^9, 3.876373281901885*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"4f70f86d-c47b-4a1a-b2d3-e94888aed272"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export example trajectories for python / blender scripts", "Subsection",
 CellChangeTimes->{{3.876211684824133*^9, 3.876211687491818*^9}, {
  3.876216291171008*^9, 3.876216291828706*^9}, {3.876278401973187*^9, 
  3.8762784154034863`*^9}, {3.87628050876005*^9, 3.876280509659204*^9}, {
  3.876372998181967*^9, 
  3.876373021645277*^9}},ExpressionUUID->"49117bdc-ab77-4159-8667-\
916cd02a010c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"generic", " ", "lensing"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"xv", ",", "kv", ",", "x0", ",", "k0", ",", "t"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "k0"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1.7"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.84", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "obtain", " ", "solution", " ", "with", " ", "initial", " ", 
      "conditions", " ", "x0"}], ",", " ", "k0"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xv", "[", "t_", "]"}], ",", 
       RowBox[{"kv", "[", "t_", "]"}], ",", "tf"}], "}"}], "=", 
     RowBox[{"solutionSEOMLinearized", "[", 
      RowBox[{"x0", ",", "k0", ",", 
       RowBox[{"vF", "=", "1"}], ",", 
       RowBox[{"\[Rho]t", "=", "1"}], ",", 
       RowBox[{"\[Alpha]", "=", "0.5"}], ",", 
       RowBox[{"\[Chi]", "=", 
        RowBox[{"+", "1"}]}], ",", 
       RowBox[{"ti", "=", 
        RowBox[{"-", "10.7"}]}], ",", 
       RowBox[{"tf", "=", "20"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"makePlots2D", "[", 
     RowBox[{
     "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "xv", ",", "kv", ",", 
      "ti", ",", "tf", ",", "1", ",", "3"}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plots", "=", 
     RowBox[{"makePlots2D", "[", 
      RowBox[{
      "\[Rho]t", ",", "\[Alpha]", ",", "\[Chi]", ",", "xv", ",", "kv", ",", 
       "ti", ",", "tf", ",", "2", ",", "3", ",", "False"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"plots", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", 
      RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}]}], "]"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plots", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.876202449607046*^9, 3.87620246460498*^9}, {
   3.8762025042416563`*^9, 3.8762025081708508`*^9}, {3.8762025478315353`*^9, 
   3.876202549523097*^9}, {3.876202734464232*^9, 3.876202749041786*^9}, {
   3.8762027854989653`*^9, 3.876202828917985*^9}, {3.8762029446456547`*^9, 
   3.87620295351633*^9}, {3.876202990878449*^9, 3.876202990962721*^9}, {
   3.876203098940886*^9, 3.876203158753994*^9}, {3.876209195144755*^9, 
   3.8762092252484627`*^9}, {3.8762092644491997`*^9, 
   3.8762093079588137`*^9}, {3.876209372194146*^9, 3.8762094492272663`*^9}, 
   3.876211207888198*^9, {3.876211581456253*^9, 3.876211581541545*^9}, {
   3.8762116996724987`*^9, 3.876211699784801*^9}, 3.876211757114768*^9, 
   3.876212057023203*^9, {3.8762122808459578`*^9, 3.8762123132928753`*^9}, {
   3.876212782704933*^9, 3.8762128068350887`*^9}, {3.876212839824224*^9, 
   3.876212931826804*^9}, {3.876212973997509*^9, 3.876212992936593*^9}, {
   3.8762130573551407`*^9, 3.8762130977154284`*^9}, {3.87621331494979*^9, 
   3.876213374062437*^9}, {3.8762134601379833`*^9, 3.8762134602508307`*^9}, {
   3.876214135350264*^9, 3.8762141565470552`*^9}, {3.8762160077046213`*^9, 
   3.8762160078519773`*^9}, {3.876216665273892*^9, 3.876216665559404*^9}, {
   3.876278431039276*^9, 3.87627844491685*^9}, {3.8762792000630083`*^9, 
   3.876279200212097*^9}, {3.876279294801033*^9, 3.876279301047196*^9}, {
   3.876279561623369*^9, 3.876279604254713*^9}, {3.8762801131120443`*^9, 
   3.876280129618326*^9}, {3.876280164523526*^9, 3.876280187106764*^9}, {
   3.876374609467863*^9, 3.876374687513371*^9}, 3.876374978965086*^9, {
   3.876375020809722*^9, 3.876375115849485*^9}, {3.876375230483272*^9, 
   3.876375329044094*^9}, {3.876379341386565*^9, 3.8763793415683393`*^9}, {
   3.8763805655612707`*^9, 3.876380943740837*^9}, 3.876381685668622*^9, {
   3.876383238777837*^9, 3.876383242775375*^9}, {3.8763833192134323`*^9, 
   3.876383328052514*^9}, {3.8763845083300457`*^9, 3.8763845414694357`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"cf693b3d-22bc-4078-a2d1-05b202ac0c11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"create", " ", "all", " ", "necessary", " ", "data"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"xs", ",", "ks", ",", "ts", ",", "Nt"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nt", "=", "201"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ts", "=", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"ti", ",", "tf", ",", 
        FractionBox[
         RowBox[{"tf", "-", "ti"}], "Nt"]}], "]"}], "//", "N"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"ts", ",", "0"}], "]"}]}], ",", 
      RowBox[{"ts", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"ts", ",", "0"}], "]"}], "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"add", " ", "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{"{", "ts", "}"}], "\[Transpose]"}], ",", "2"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", "\"\<t\>\"", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "\[Alpha]", "}"}], "&"}], "/@", "ts"}], ",", "2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", "\"\<\\\\alpha\>\"", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "\[Chi]", "}"}], "&"}], "/@", "ts"}], ",", "2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", "\"\<\\\\chi\>\"", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "vF", "}"}], "&"}], "/@", "ts"}], ",", "2"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", "\"\<v_F\>\"", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "\[Rho]t", "}"}], "&"}], "/@", "ts"}], ",", "2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", "\"\<\\\\rho_t\>\"", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"add", " ", "spatial", " ", "coordinates"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"xv", "[", "#", "]"}], "&"}], "/@", "ts"}], ",", "2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", " ", "\"\<z\>\""}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"xv", "'"}], "[", "#", "]"}], "&"}], "/@", "ts"}], ",", 
       "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\\\\dot x\>\"", ",", "\"\<\\\\dot y\>\"", ",", " ", 
         "\"\<\\\\dot z\>\""}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"xv", "''"}], "[", "#", "]"}], "&"}], "/@", "ts"}], ",", 
       "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\\\\ddot x\>\"", ",", "\"\<\\\\ddot y\>\"", ",", " ", 
         "\"\<\\\\ddot z\>\""}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"add", " ", "momentum", " ", "coordinates"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"kv", "[", "#", "]"}], "&"}], "/@", "ts"}], ",", "2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<k_x\>\"", ",", "\"\<k_y\>\"", ",", " ", "\"\<k_z\>\""}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"spin", ",", " ", 
     RowBox[{"angular", " ", "moment"}], ",", " ", 
     RowBox[{
     "total", " ", "angular", " ", "moment", " ", "and", " ", "energy"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"spin", "[", 
          RowBox[{"\[Chi]", ",", 
           RowBox[{"kv", "[", "#", "]"}]}], "]"}], "&"}], "/@", "ts"}], ",", 
       "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<s_x\>\"", ",", "\"\<s_y\>\"", ",", " ", "\"\<s_z\>\""}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{
           RowBox[{"xv", "[", "#", "]"}], ",", 
           RowBox[{"kv", "[", "#", "]"}]}], "]"}], "&"}], "/@", "ts"}], ",", 
       "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<L_x\>\"", ",", "\"\<L_y\>\"", ",", " ", "\"\<L_z\>\""}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"J", "[", 
          RowBox[{"\[Chi]", ",", 
           RowBox[{"xv", "[", "#", "]"}], ",", 
           RowBox[{"kv", "[", "#", "]"}]}], "]"}], "&"}], "/@", "ts"}], ",", 
       "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<J_x\>\"", ",", "\"\<J_y\>\"", ",", " ", "\"\<J_z\>\""}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"\[Alpha]", ",", "vF", ",", "\[Rho]t", ",", 
            RowBox[{"xv", "[", "#", "]"}], ",", 
            RowBox[{"kv", "[", "#", "]"}]}], "]"}], "}"}], "&"}], "/@", 
        "ts"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"header", ",", 
       RowBox[{"{", "\"\<E\>\"", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"data", ",", "header"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"pathOut", "=", 
     RowBox[{"SetDirectory", "[", 
      RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"pathOut", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\</lensing_example_chi_`1`.csv\>\"", ",", "\[Chi]", ",", "\[Rho]t",
          ",", "vF"}], "]"}], "]"}]}], ",", "data"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.876202449607046*^9, 3.87620246460498*^9}, {
   3.8762025042416563`*^9, 3.8762025081708508`*^9}, {3.8762025478315353`*^9, 
   3.876202549523097*^9}, {3.876202734464232*^9, 3.876202749041786*^9}, {
   3.8762027854989653`*^9, 3.876202828917985*^9}, {3.8762029446456547`*^9, 
   3.87620295351633*^9}, {3.876202990878449*^9, 3.876202990962721*^9}, {
   3.876203098940886*^9, 3.876203158753994*^9}, {3.876209195144755*^9, 
   3.8762092252484627`*^9}, {3.8762092644491997`*^9, 
   3.8762093079588137`*^9}, {3.876209372194146*^9, 3.8762094492272663`*^9}, 
   3.876211207888198*^9, {3.876211581456253*^9, 3.876211581541545*^9}, {
   3.8762116996724987`*^9, 3.876211699784801*^9}, 3.876211757114768*^9, 
   3.876212057023203*^9, {3.8762122808459578`*^9, 3.8762123132928753`*^9}, {
   3.876212782704933*^9, 3.8762128068350887`*^9}, {3.876212839824224*^9, 
   3.876212931826804*^9}, {3.876212973997509*^9, 3.876212992936593*^9}, {
   3.8762130573551407`*^9, 3.8762130977154284`*^9}, {3.87621331494979*^9, 
   3.876213374062437*^9}, {3.8762134601379833`*^9, 3.8762134602508307`*^9}, {
   3.876214135350264*^9, 3.8762141565470552`*^9}, {3.8762160077046213`*^9, 
   3.8762160078519773`*^9}, {3.876216665273892*^9, 3.876216665559404*^9}, {
   3.876278431039276*^9, 3.87627844491685*^9}, {3.8762792000630083`*^9, 
   3.876279200212097*^9}, {3.876279294801033*^9, 3.876279301047196*^9}, {
   3.876279561623369*^9, 3.876279604254713*^9}, {3.8762801131120443`*^9, 
   3.876280129618326*^9}, {3.876280164523526*^9, 3.876280187106764*^9}, {
   3.876374609467863*^9, 3.876374687513371*^9}, 3.876374978965086*^9, {
   3.876375020809722*^9, 3.876375115849485*^9}, {3.876375230483272*^9, 
   3.876375329044094*^9}, {3.876379341386565*^9, 3.8763793415683393`*^9}, {
   3.8763805655612707`*^9, 3.876380660805534*^9}, {3.8763811433135*^9, 
   3.876381148229204*^9}, {3.87638119011854*^9, 3.8763812194903107`*^9}, {
   3.8763813815607147`*^9, 3.876381381736446*^9}, {3.876381648709656*^9, 
   3.87638165273878*^9}, {3.876382839957404*^9, 3.8763828400478487`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"3589b920-69ac-444b-a2c3-ae99e4c2a3d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["More details on the analytic calculations", "Subsection",
 CellChangeTimes->{{3.876373372245982*^9, 
  3.876373391249958*^9}},ExpressionUUID->"6510a8d2-13a6-484c-876d-\
485680ac8612"],

Cell[CellGroupData[{

Cell["Sec. 4", "Subsubsection",
 CellChangeTimes->{{3.876811692373001*^9, 
  3.876811718746792*^9}},ExpressionUUID->"ffd0239c-63a7-4ab4-912c-\
a4dd822db9e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "two", " ", "Weyl"}], "-", 
    RowBox[{"node", " ", "model"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "H2", ",", "ux", ",", "uy", ",", "uz", ",", "kx", ",", "ky", ",", "kz", 
     ",", "k0", ",", "m", ",", "vF"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H2", "[", 
     RowBox[{
     "ux_", ",", "uy_", ",", "uz_", ",", "kx_", ",", "ky_", ",", "kz_", ",", 
      "k0_", ",", "m_", ",", "vF_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ux", ",", "uy", ",", "uz"}], "}"}], ".", 
       RowBox[{"{", 
        RowBox[{"kx", ",", "ky", ",", 
         RowBox[{"kz", "+", "k0"}]}], "}"}]}], "*", 
      RowBox[{"PauliMatrix", "[", "0", "]"}]}], "+", 
     RowBox[{"vF", "*", "kx", "*", 
      RowBox[{"PauliMatrix", "[", "1", "]"}]}], "+", 
     RowBox[{"vF", "*", "ky", "*", 
      RowBox[{"PauliMatrix", "[", "2", "]"}]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", "m"}]], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kx", "2"], "+", 
        SuperscriptBox["ky", "2"], "+", 
        SuperscriptBox["kz", "2"], "-", 
        SuperscriptBox["k0", "2"]}], ")"}], 
      RowBox[{"PauliMatrix", "[", "3", "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.876809723543779*^9, 3.876809802707404*^9}, {
   3.8768098534959097`*^9, 3.87680991785394*^9}, {3.876809957965789*^9, 
   3.8768099583677673`*^9}, {3.8768100533909607`*^9, 3.876810080850142*^9}, 
   3.8768104683261642`*^9, {3.876811361836707*^9, 3.87681136433875*^9}, {
   3.876811706568321*^9, 3.876811713648871*^9}},
 CellLabel->
  "In[434]:=",ExpressionUUID->"428b3b28-00d9-4c79-b677-6888aa462ba3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "lattice", " ", "model"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "Hlatt", ",", "ux", ",", "uy", ",", "uz", ",", "kx", ",", "ky", ",", "kz",
      ",", "k0", ",", "m", ",", "vF"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hlatt", "[", 
     RowBox[{
     "ux_", ",", "uy_", ",", "kx_", ",", "ky_", ",", "m_", ",", "vF_", ",", 
      " ", "a_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "a"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ux", ",", "uy"}], "}"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"kx", " ", "a"}], "]"}], ",", 
            RowBox[{"Sin", "[", 
             RowBox[{"ky", " ", "a"}], "]"}]}], "}"}]}], "*", 
         RowBox[{"PauliMatrix", "[", "0", "]"}]}], "+", "\[IndentingNewLine]", 
        RowBox[{"vF", "*", 
         RowBox[{"Sin", "[", 
          RowBox[{"kx", " ", "a"}], "]"}], "*", 
         RowBox[{"PauliMatrix", "[", "1", "]"}]}], "+", 
        RowBox[{"vF", "*", 
         RowBox[{"Sin", "[", 
          RowBox[{"ky", " ", "a"}], "]"}], "*", 
         RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], ")"}]}], "+", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"m", " ", 
        SuperscriptBox["a", "2"]}]], "*", 
      RowBox[{"(", 
       RowBox[{"2", "-", 
        RowBox[{"Cos", "[", 
         RowBox[{"kx", " ", "a"}], "]"}], " ", "-", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"ky", " ", "a"}], "]"}]}], ")"}], 
      RowBox[{"PauliMatrix", "[", "3", "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.876809723543779*^9, 3.876809802707404*^9}, {
   3.8768098534959097`*^9, 3.87680991785394*^9}, {3.876809957965789*^9, 
   3.8768099583677673`*^9}, {3.8768100533909607`*^9, 3.876810080850142*^9}, 
   3.8768104683261642`*^9, {3.876811361836707*^9, 3.876811490930994*^9}, {
   3.876811631880939*^9, 3.876811636160593*^9}, {3.8768123827746553`*^9, 
   3.8768124256926737`*^9}, {3.876812470941733*^9, 3.876812477679008*^9}, {
   3.876814195355249*^9, 3.876814241237029*^9}, 3.876814357375114*^9},
 CellLabel->
  "In[436]:=",ExpressionUUID->"395b4dad-1135-4d75-ab3c-2fc7ba8dd6b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "Elatt", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "dispersion", " ", "at", " ", 
     SuperscriptBox["a", "2"], 
     SuperscriptBox["m", "2"], 
     SuperscriptBox["vF", "2"]}], "=", 
    RowBox[{"1", " ", "[", 
     RowBox[{
      RowBox[{"note", " ", "that", " ", "then", " ", 
       SubscriptBox["v", "F"]}], "=", 
      RowBox[{"(", "ma", ")"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Elatt", "[", 
   RowBox[{
   "ux_", ",", "uy_", ",", "kx_", ",", "ky_", ",", "m_", ",", "vF_", ",", 
    "a_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["vF", "a"]}], 
      SqrtBox[
       RowBox[{"6", "-", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", " ", "kx"}], "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", " ", "ky"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", " ", "kx"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", " ", "ky"}], "]"}]}]}]]}], "+", 
     FractionBox[
      RowBox[{"ux", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", " ", "kx"}], "]"}]}], "a"], "+", 
     FractionBox[
      RowBox[{"uy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", " ", "ky"}], "]"}]}], "a"]}], ",", 
    RowBox[{
     RowBox[{
      FractionBox["vF", "a"], 
      SqrtBox[
       RowBox[{"6", "-", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", " ", "kx"}], "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", " ", "ky"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", " ", "kx"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", " ", "ky"}], "]"}]}]}]]}], "+", 
     FractionBox[
      RowBox[{"ux", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", " ", "kx"}], "]"}]}], "a"], "+", 
     FractionBox[
      RowBox[{"uy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", " ", "ky"}], "]"}]}], "a"]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.876811476791834*^9, 3.8768115718051043`*^9}, {
   3.876811647357493*^9, 3.876811676885544*^9}, {3.876812549434834*^9, 
   3.876812640984289*^9}, {3.876814099441576*^9, 3.8768141191216183`*^9}, 
   3.876814260256585*^9, {3.876814295981893*^9, 3.876814312458159*^9}, {
   3.876814359448275*^9, 3.8768143656994953`*^9}, {3.876814442864758*^9, 
   3.8768144525606937`*^9}, {3.87681503137748*^9, 3.876815038838727*^9}},
 CellLabel->
  "In[438]:=",ExpressionUUID->"0b2b39a4-e19f-4837-81a4-77fa2700b5cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"Hlatt", "[", 
       RowBox[{
       "ux", ",", "uy", ",", "kx", ",", "ky", ",", "m", ",", "vF", ",", " ", 
        "a"}], "]"}], "]"}], "//", "ExpandAll"}], ")"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"%", "-", 
      RowBox[{"Elatt", "[", 
       RowBox[{
       "ux", ",", "uy", ",", "kx", ",", "ky", ",", "m", ",", "vF", ",", "a"}],
        "]"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["vF", "2"]}], "\[Rule]", "1"}], "}"}]}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", " ", "m", " ", "vF"}], "\[Rule]", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.876814332242832*^9, 3.876814350881239*^9}, {
  3.8768144119183273`*^9, 3.876814413834354*^9}, {3.8768144579939747`*^9, 
  3.876814469364354*^9}, {3.876814527981999*^9, 3.876814624930656*^9}, {
  3.876814839108073*^9, 3.876814844553651*^9}, {3.8768149318432417`*^9, 
  3.876814979834371*^9}, {3.876815048129498*^9, 3.8768151016778803`*^9}},
 CellLabel->
  "In[440]:=",ExpressionUUID->"eeb0bb74-897e-4568-8d38-8ea00673057e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"around", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["k", "x"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["k", "y"], "2"]}]]}], "=", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "dispersion", " ", "is", " ", "linear"}], " ", 
     "..."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"Elatt", "[", 
          RowBox[{"ux", ",", "uy", ",", 
           RowBox[{"kx", " ", "t"}], ",", 
           RowBox[{"ky", " ", "t"}], ",", "m", ",", "vF", ",", "a"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"t", "\[Rule]", "1"}]}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"a", ">", "0"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.876813400431253*^9, 3.876813454987874*^9}, {
   3.876813504320331*^9, 3.8768135467521677`*^9}, {3.876813581311914*^9, 
   3.876813645612281*^9}, 3.8768140037217417`*^9, {3.876814128922213*^9, 
   3.876814131756481*^9}, {3.8768141676435003`*^9, 3.876814180622347*^9}, {
   3.876815136719487*^9, 3.876815166806065*^9}},
 CellLabel->
  "In[442]:=",ExpressionUUID->"79c4d23f-5dbf-46b6-8e3e-c07a23eb3743"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "...", " ", "and", " ", "H2", " ", "is", " ", "equivalent", " ", "to", " ",
     "Hlatt"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"Hlatt", "[", 
          RowBox[{"ux", ",", "uy", ",", 
           RowBox[{"kx", " ", "t"}], ",", 
           RowBox[{"ky", " ", "t"}], ",", "m", ",", "vF", ",", " ", "a"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"t", "\[Rule]", "1"}]}], "]"}], "-", 
    RowBox[{"H2", "[", 
     RowBox[{"ux", ",", "uy", ",", "uz", ",", "kx", ",", "ky", ",", 
      RowBox[{"-", "k0"}], ",", "k0", ",", "m", ",", "vF"}], "]"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.8768140184544497`*^9, 3.876814075788149*^9}, {
  3.876814154776135*^9, 3.876814156124956*^9}, {3.876815117524646*^9, 
  3.876815164173203*^9}},
 CellLabel->
  "In[443]:=",ExpressionUUID->"b0b1ccf3-bf5b-4b05-b503-9285fc3e864c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"extract", " ", "eigensystem"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "fun", ",", "eval", ",", "evec", ",", "evecnorm", ",", "nevec", ",", 
     "nevecc"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fun", "[", 
      RowBox[{"ux_", ",", "uy_", ",", "kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Eigensystem", "[", 
          RowBox[{"Hlatt", "[", 
           RowBox[{
           "ux", ",", "uy", ",", "kx", ",", "ky", ",", "m", ",", "vF", ",", 
            "a"}], "]"}], "]"}], "//", "ExpandAll"}], "//", "FullSimplify"}], 
       ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"a", " ", "m", " ", "vF"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["m", "2"], " ", 
          SuperscriptBox["vF", "2"]}], "\[Rule]", "1"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"eval", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"fun", "[", 
       RowBox[{"ux", ",", "uy", ",", "kx", ",", "ky"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"evec", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "4"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", "kx", "]"}]}], "+", 
            RowBox[{
             SqrtBox["2"], " ", 
             SqrtBox[
              RowBox[{"12", "+", 
               RowBox[{"4", " ", 
                RowBox[{"Cos", "[", "kx", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", 
                  RowBox[{"Cos", "[", "ky", "]"}]}], ")"}]}], "-", 
               RowBox[{"8", " ", 
                RowBox[{"Cos", "[", "ky", "]"}]}]}]]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", "ky", "]"}]}]}], 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"Sin", "[", "kx", "]"}]}], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", "ky", "]"}]}]}]]}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"4", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "kx", "]"}]}], "+", 
           RowBox[{
            SqrtBox["2"], " ", 
            SqrtBox[
             RowBox[{"12", "+", 
              RowBox[{"4", " ", 
               RowBox[{"Cos", "[", "kx", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 RowBox[{"Cos", "[", "ky", "]"}]}], ")"}]}], "-", 
              RowBox[{"8", " ", 
               RowBox[{"Cos", "[", "ky", "]"}]}]}]]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "ky", "]"}]}]}], 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", "kx", "]"}]}], "+", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", "ky", "]"}]}]}]], ",", "1"}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"evecc", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "4"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", "kx", "]"}]}], "+", 
            RowBox[{
             SqrtBox["2"], " ", 
             SqrtBox[
              RowBox[{"12", "+", 
               RowBox[{"4", " ", 
                RowBox[{"Cos", "[", "kx", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", 
                  RowBox[{"Cos", "[", "ky", "]"}]}], ")"}]}], "-", 
               RowBox[{"8", " ", 
                RowBox[{"Cos", "[", "ky", "]"}]}]}]]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", "ky", "]"}]}]}], 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"Sin", "[", "kx", "]"}]}], "-", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", "ky", "]"}]}]}]]}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"4", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "kx", "]"}]}], "+", 
           RowBox[{
            SqrtBox["2"], " ", 
            SqrtBox[
             RowBox[{"12", "+", 
              RowBox[{"4", " ", 
               RowBox[{"Cos", "[", "kx", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 RowBox[{"Cos", "[", "ky", "]"}]}], ")"}]}], "-", 
              RowBox[{"8", " ", 
               RowBox[{"Cos", "[", "ky", "]"}]}]}]]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "ky", "]"}]}]}], 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", "kx", "]"}]}], "-", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", "ky", "]"}]}]}]], ",", "1"}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"normalize", " ", "the", " ", "vectors"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"evecnorm", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"{", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{"evecc", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ".", 
          RowBox[{
           RowBox[{"evec", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]], ",", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{"evecc", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ".", 
          RowBox[{
           RowBox[{"evec", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nevec", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"evec", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/", 
         RowBox[{
          RowBox[{"evecnorm", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"evec", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nevecc", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"evecc", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/", 
         RowBox[{
          RowBox[{"evecnorm", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"evecc", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8768152021789083`*^9, 3.8768152872186747`*^9}, {
   3.876815396302915*^9, 3.876815604994919*^9}, {3.876815648683874*^9, 
   3.876815649556582*^9}, {3.876815714957466*^9, 3.876815794870042*^9}, {
   3.8768206189851627`*^9, 3.8768207781166153`*^9}, {3.8768208174513817`*^9, 
   3.8768208687657547`*^9}, {3.8768209285552683`*^9, 3.876820941832024*^9}, 
   3.876821002441983*^9},
 CellLabel->
  "In[546]:=",ExpressionUUID->"b5b57a2e-d749-4f72-9e6b-1c45036e63c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"they", " ", "are", " ", "normalized", " ", "eigenstates"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"nevecc", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Hlatt", "[", 
        RowBox[{
        "ux", ",", "uy", ",", "kx", ",", "ky", ",", "1", ",", "1", ",", "1"}],
         "]"}], ".", 
       RowBox[{
        RowBox[{"nevec", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"nevecc", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Hlatt", "[", 
        RowBox[{
        "ux", ",", "uy", ",", "kx", ",", "ky", ",", "1", ",", "1", ",", "1"}],
         "]"}], ".", 
       RowBox[{
        RowBox[{"nevec", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.876815650721528*^9, 3.876815706458036*^9}, {
  3.876815807096013*^9, 3.876815814469809*^9}, {3.876815861391403*^9, 
  3.876815861975507*^9}, {3.876820581542972*^9, 3.87682061134407*^9}, {
  3.876820884557416*^9, 3.876820923001133*^9}, {3.876821940263462*^9, 
  3.8768219479671783`*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"afd985a0-fe31-41ad-af09-cabcadbb5097"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"nevec", "[", 
        RowBox[{
         RowBox[{"kx", " ", "t"}], ",", 
         RowBox[{"ky", " ", "t"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "t"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"t", "->", "1"}], "}"}]}], ")"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8768251716271687`*^9, 3.876825188540935*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"09309fff-57dd-44e8-9452-8b8cf72e5e9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Berry", " ", "connection"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"nevec", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nevec", "[", 
         RowBox[{
          RowBox[{"kx", " ", "t"}], ",", 
          RowBox[{"ky", " ", "t"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "t"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"t", "->", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.876822299598793*^9, 3.8768223951653214`*^9}, {
  3.876822434576187*^9, 
  3.876822463111391*^9}},ExpressionUUID->"4469f8b4-eedc-43e7-b1a3-\
241a148ea171"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 1027},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> True}, "TryRealOnly" -> False},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2ac68a4d-f479-4ba3-b580-4dc5c557e2c6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 678, 15, 165, "Subtitle",ExpressionUUID->"85bcbaea-da79-47a9-8841-3e5fd17331cb"],
Cell[1261, 39, 588, 17, 73, "Text",ExpressionUUID->"972199aa-7d14-4887-b813-b221dd610ba3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1874, 60, 227, 4, 67, "Subsection",ExpressionUUID->"16834aeb-6dc8-44ad-b1a3-534a9027c016"],
Cell[CellGroupData[{
Cell[2126, 68, 165, 3, 56, "Subsubsection",ExpressionUUID->"bf937a19-27d2-4354-aaf4-706dd50f00fe"],
Cell[2294, 73, 19446, 435, 1631, "Input",ExpressionUUID->"8c845484-fbdb-440b-9c72-f8615d0ef9dd",
 InitializationCell->True],
Cell[21743, 510, 6463, 105, 110, "Input",ExpressionUUID->"4f22d022-b777-4da8-bee6-99a5ec583125",
 InitializationCell->True],
Cell[28209, 617, 5818, 83, 57, "Input",ExpressionUUID->"f2a61410-9d2d-4663-9dde-d0f4096b7917",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[34064, 705, 159, 3, 45, "Subsubsection",ExpressionUUID->"7ef52e73-a8a0-414d-bc87-366b20317915"],
Cell[34226, 710, 16851, 422, 1954, "Input",ExpressionUUID->"8993ef5f-aa5a-4840-baed-a3ef0d44ff0c",
 InitializationCell->True],
Cell[51080, 1134, 1390, 39, 110, "Input",ExpressionUUID->"07001438-fc15-4819-b89d-bdc34fe5fe08",
 InitializationCell->True],
Cell[52473, 1175, 1265, 32, 110, "Input",ExpressionUUID->"c1f8ba6c-be24-45f4-8e20-fdef409918cf",
 InitializationCell->True],
Cell[53741, 1209, 16507, 407, 1711, "Input",ExpressionUUID->"32b1e47c-a4b0-4d8a-9e85-6e3c67104036",
 InitializationCell->True],
Cell[70251, 1618, 1411, 41, 110, "Input",ExpressionUUID->"b22d2150-4be4-4b8d-b995-000b319fdb10",
 InitializationCell->True],
Cell[71665, 1661, 2285, 47, 162, "Input",ExpressionUUID->"94eb6e50-e931-4e98-94d0-5d435172058c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[73987, 1713, 164, 3, 45, "Subsubsection",ExpressionUUID->"8a19a71f-2c87-4dfe-acc9-c9c236223541"],
Cell[74154, 1718, 10134, 254, 1154, "Input",ExpressionUUID->"2eb269a6-aef2-4b4e-8628-13f5f2b3580e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[84325, 1977, 169, 3, 45, "Subsubsection",ExpressionUUID->"5a03dbae-22f6-4134-950d-a2d224cabd7f"],
Cell[84497, 1982, 9167, 241, 999, "Input",ExpressionUUID->"fe9c22e8-f27d-42e2-b49a-0961909f16b1",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93713, 2229, 273, 4, 67, "Subsection",ExpressionUUID->"86b1f668-e169-4b17-a61c-a53b2d76c76a"],
Cell[CellGroupData[{
Cell[94011, 2237, 382, 11, 57, "Subsubsection",ExpressionUUID->"ddbfbf95-e699-4310-ac22-3ca21f7da378"],
Cell[94396, 2250, 3315, 74, 226, "Input",ExpressionUUID->"8ba5295b-26f2-4ec7-beaa-69609c75fdc1"],
Cell[97714, 2326, 297, 5, 37, "Input",ExpressionUUID->"eed48ea0-ba51-4d7b-a819-2ff09be0b262"]
}, Closed]],
Cell[CellGroupData[{
Cell[98048, 2336, 438, 11, 46, "Subsubsection",ExpressionUUID->"e400a94b-50e9-4a76-9b3f-7b27548d0b58"],
Cell[98489, 2349, 2910, 65, 175, "Input",ExpressionUUID->"be4390f1-80cd-4645-8f77-51169d87dec9"]
}, Closed]],
Cell[CellGroupData[{
Cell[101436, 2419, 311, 5, 45, "Subsubsection",ExpressionUUID->"99db847d-8409-429b-a999-e56108e9aafa"],
Cell[101750, 2426, 3463, 78, 270, "Input",ExpressionUUID->"f86fa1e1-9ccf-4d85-b2c6-d98abf7c18f6"]
}, Closed]],
Cell[CellGroupData[{
Cell[105250, 2509, 353, 6, 45, "Subsubsection",ExpressionUUID->"70471d8d-9051-45ec-b1bf-98b5dbc06736"],
Cell[105606, 2517, 3596, 80, 375, "Input",ExpressionUUID->"f61fd84f-76b3-4026-a36f-2db6bd32ce3e"]
}, Closed]],
Cell[CellGroupData[{
Cell[109239, 2602, 587, 8, 45, "Subsubsection",ExpressionUUID->"977ef9f1-d520-447a-aea5-6b4db1dd0f7f"],
Cell[109829, 2612, 3770, 79, 193, "Input",ExpressionUUID->"4be2b3d6-6039-4c41-8c75-bea2e0b1ef46"],
Cell[113602, 2693, 3892, 82, 167, "Input",ExpressionUUID->"1dd9376b-1516-4239-8a71-b24e840df1cb"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[117543, 2781, 281, 4, 67, "Subsection",ExpressionUUID->"471f9e0e-9fd6-41aa-88e7-07f9cf41fd74"],
Cell[CellGroupData[{
Cell[117849, 2789, 164, 3, 56, "Subsubsection",ExpressionUUID->"4241d1b9-6af5-44b4-8bca-4bf29d0c6b6e"],
Cell[118016, 2794, 3469, 76, 174, "Input",ExpressionUUID->"d47f2d2d-d412-4165-a857-008bf648df85"],
Cell[121488, 2872, 1695, 40, 142, "Input",ExpressionUUID->"8af3d2f2-481f-4b92-87fc-911d38acc3fe"],
Cell[123186, 2914, 2227, 54, 237, "Input",ExpressionUUID->"0583762d-6a2c-4743-829f-49831259bc0b"],
Cell[125416, 2970, 2193, 58, 165, "Input",ExpressionUUID->"96cd8e0f-a2b3-4cd7-a909-e1ef93fabc14"],
Cell[127612, 3030, 1843, 53, 294, "Input",ExpressionUUID->"25d2edc8-bba5-46cd-b9c0-42e2ba3ad368"],
Cell[129458, 3085, 1714, 52, 221, "Input",ExpressionUUID->"b57f2315-6a47-4e3b-ae1f-9a8347fb422c"],
Cell[131175, 3139, 2996, 81, 350, "Input",ExpressionUUID->"7d178f7e-6901-4b9d-a916-d71c597080ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134208, 3225, 217, 4, 56, "Subsubsection",ExpressionUUID->"7342a176-fb88-4a7e-aa53-ccd7ffc4c5c0"],
Cell[134428, 3231, 3332, 87, 359, "Input",ExpressionUUID->"0870effe-ba71-4e8d-a338-a94599cb3c53"],
Cell[137763, 3320, 2158, 53, 234, "Input",ExpressionUUID->"5d7730f4-65a9-493b-aa98-8da6183930da"],
Cell[139924, 3375, 1779, 55, 177, "Input",ExpressionUUID->"a85c11fc-8b0a-4442-a071-07dc02d72d9a"],
Cell[141706, 3432, 2271, 56, 211, "Input",ExpressionUUID->"70ecd69f-ad24-4f6d-bc8e-da9914222290"],
Cell[143980, 3490, 3228, 85, 428, "Input",ExpressionUUID->"2f506285-d9ef-4390-a2ff-000ce71b54d0"],
Cell[147211, 3577, 726, 22, 64, "Input",ExpressionUUID->"efcc4684-5dac-4301-a601-8953e0d205e5"],
Cell[147940, 3601, 1510, 45, 116, "Input",ExpressionUUID->"9d970bf1-1d08-4035-aa7e-4ea10000a43b"],
Cell[149453, 3648, 1515, 46, 116, "Input",ExpressionUUID->"4f70f86d-c47b-4a1a-b2d3-e94888aed272"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151017, 3700, 398, 6, 67, "Subsection",ExpressionUUID->"49117bdc-ab77-4159-8667-916cd02a010c"],
Cell[151418, 3708, 4477, 97, 246, "Input",ExpressionUUID->"cf693b3d-22bc-4078-a2d1-05b202ac0c11"],
Cell[155898, 3807, 11149, 302, 1076, "Input",ExpressionUUID->"3589b920-69ac-444b-a2c3-ae99e4c2a3d9"]
}, Closed]],
Cell[CellGroupData[{
Cell[167084, 4114, 189, 3, 46, "Subsection",ExpressionUUID->"6510a8d2-13a6-484c-876d-485680ac8612"],
Cell[CellGroupData[{
Cell[167298, 4121, 157, 3, 56, "Subsubsection",ExpressionUUID->"ffd0239c-63a7-4ab4-912c-a4dd822db9e0"],
Cell[167458, 4126, 1795, 45, 163, "Input",ExpressionUUID->"428b3b28-00d9-4c79-b677-6888aa462ba3"],
Cell[169256, 4173, 2380, 59, 217, "Input",ExpressionUUID->"395b4dad-1135-4d75-ab3c-2fc7ba8dd6b3"],
Cell[171639, 4234, 2749, 77, 192, "Input",ExpressionUUID->"0b2b39a4-e19f-4837-81a4-77fa2700b5cf"],
Cell[174391, 4313, 1345, 35, 93, "Input",ExpressionUUID->"eeb0bb74-897e-4568-8d38-8ea00673057e"],
Cell[175739, 4350, 1465, 38, 96, "Input",ExpressionUUID->"79c4d23f-5dbf-46b6-8e3e-c07a23eb3743"],
Cell[177207, 4390, 1147, 29, 90, "Input",ExpressionUUID->"b0b1ccf3-bf5b-4b05-b503-9285fc3e864c"],
Cell[178357, 4421, 8628, 242, 783, "Input",ExpressionUUID->"b5b57a2e-d749-4f72-9e6b-1c45036e63c0"],
Cell[186988, 4665, 1634, 46, 116, "Input",ExpressionUUID->"afd985a0-fe31-41ad-af09-cabcadbb5097"],
Cell[188625, 4713, 559, 17, 37, "Input",ExpressionUUID->"09309fff-57dd-44e8-9452-8b8cf72e5e9e"],
Cell[189187, 4732, 833, 24, 64, "Input",ExpressionUUID->"4469f8b4-eedc-43e7-b1a3-241a148ea171"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

